import {
  AssigneeColumn,
  StageColumn,
  getDisplayName
} from "./chunk-JSY26FDA.js";
import {
  ReleaseActionMenu,
  ReleaseActionOptions
} from "./chunk-GEX5JP45.js";
import {
  index as index2
} from "./chunk-VLDIDCFF.js";
import {
  PERMISSIONS as PERMISSIONS3,
  PLUGIN_ID,
  pluginId as pluginId2
} from "./chunk-EBVWQ5LF.js";
import {
  getTimezoneOffset,
  useCreateManyReleaseActionsMutation,
  useCreateReleaseActionMutation,
  useGetMappedEntriesInReleasesQuery,
  useGetReleasesForEntryQuery,
  useGetReleasesQuery
} from "./chunk-6DYY6YVQ.js";
import {
  buildValidParams as buildValidParams2
} from "./chunk-AK5CFNWL.js";
import {
  getStageColorByHex
} from "./chunk-LRBI77RH.js";
import {
  LimitsModal
} from "./chunk-K46P7M4Z.js";
import {
  CHARGEBEE_STAGES_PER_WORKFLOW_ENTITLEMENT_NAME,
  CHARGEBEE_WORKFLOW_ENTITLEMENT_NAME,
  FEATURE_ID,
  PLUGIN_ID as PLUGIN_ID2,
  useGetStagesQuery,
  useUpdateAssigneeMutation,
  useUpdateStageMutation
} from "./chunk-U2LLNM5R.js";
import {
  useTypedSelector
} from "./chunk-U56OTSTE.js";
import {
  PERMISSIONS as PERMISSIONS2,
  getTranslation,
  i18nApi,
  pluginId,
  useGetLocalesQuery
} from "./chunk-AUHV5HQY.js";
import {
  PERMISSIONS
} from "./chunk-PDGPTUUZ.js";
import {
  useDocumentActions
} from "./chunk-I42AUKJW.js";
import {
  buildValidParams,
  useContentManagerContext,
  useDocument,
  useDocumentLayout
} from "./chunk-CDU5ITGD.js";
import {
  useLicenseLimits
} from "./chunk-IZFYXPVU.js";
import {
  admin
} from "./chunk-PBPSGT5R.js";
import {
  renderAdmin
} from "./chunk-R54RRZSL.js";
import {
  Form,
  Formik,
  useFormik
} from "./chunk-BMK5WACR.js";
import {
  Table,
  useTable
} from "./chunk-OR64OWYD.js";
import {
  useAdminUsers
} from "./chunk-3IWTMB3M.js";
import {
  useForm
} from "./chunk-B53TSE6I.js";
import {
  useRBAC
} from "./chunk-GU5PNH7J.js";
import {
  ForwardRef$J,
  useAPIErrorHandler
} from "./chunk-IATSSX5S.js";
import {
  useAuth,
  useQueryParams
} from "./chunk-P6UVAPK6.js";
import {
  useNotification
} from "./chunk-K6X2HFMR.js";
import {
  isFetchError,
  require_lib,
  skipToken
} from "./chunk-IJRBMRJB.js";
import {
  Link,
  matchPath,
  useNavigate,
  useParams
} from "./chunk-QVPFWWZZ.js";
import {
  index
} from "./chunk-PA4QOQNE.js";
import {
  require_omit
} from "./chunk-ZHSHW6ZZ.js";
import {
  create3 as create,
  create4 as create2,
  create6 as create3,
  require_has
} from "./chunk-2DHCBD75.js";
import {
  require_get
} from "./chunk-DFSUQOXI.js";
import {
  Box,
  Button,
  CheckboxImpl,
  Combobox,
  Dialog,
  EmptyStateLayout,
  Field,
  Flex,
  IconButton,
  Link as Link2,
  LinkButton,
  Loader,
  Modal,
  Option,
  Popover,
  SingleSelect,
  SingleSelectOption,
  Status,
  TooltipImpl,
  Typography,
  VisuallyHidden,
  useCollator,
  useIntl
} from "./chunk-4UXIB2ZA.js";
import {
  ForwardRef$11,
  ForwardRef$1F,
  ForwardRef$1l,
  ForwardRef$1z,
  ForwardRef$2r,
  ForwardRef$3X,
  ForwardRef$4$,
  ForwardRef$4L,
  ForwardRef$4b,
  ForwardRef$4d,
  ForwardRef$5,
  ForwardRef$5h,
  ForwardRef$n
} from "./chunk-67WISF62.js";
import {
  require_jsx_runtime
} from "./chunk-NIAJZ5MX.js";
import {
  at
} from "./chunk-IUZOBZCP.js";
import {
  require_react
} from "./chunk-MADUDGYZ.js";
import {
  __toESM
} from "./chunk-PLDDJCW6.js";

// node_modules/@strapi/email/dist/admin/utils/prefixPluginTranslations.mjs
var prefixPluginTranslations = (trad, pluginId3) => {
  return Object.keys(trad).reduce((acc, current) => {
    acc[`${pluginId3}.${current}`] = trad[current];
    return acc;
  }, {});
};

// node_modules/@strapi/email/dist/admin/index.mjs
function __variableDynamicImportRuntime1__(path) {
  switch (path) {
    case "./translations/ar.json":
      return import("./ar.json-XT2AE5MD.js");
    case "./translations/cs.json":
      return import("./cs.json-5JA7XHIC.js");
    case "./translations/de.json":
      return import("./de.json-7VRMCTYR.js");
    case "./translations/dk.json":
      return import("./dk.json-XKI7CLW6.js");
    case "./translations/en.json":
      return import("./en.json-MD5H2ZNO.js");
    case "./translations/es.json":
      return import("./es.json-WU2KAU5P.js");
    case "./translations/fr.json":
      return import("./fr.json-HZUEJNY3.js");
    case "./translations/id.json":
      return import("./id.json-FHZVCNDO.js");
    case "./translations/it.json":
      return import("./it.json-B3SKNTFX.js");
    case "./translations/ja.json":
      return import("./ja.json-EZKJRE4T.js");
    case "./translations/ko.json":
      return import("./ko.json-IY4N3EIS.js");
    case "./translations/ms.json":
      return import("./ms.json-XXLISYOZ.js");
    case "./translations/nl.json":
      return import("./nl.json-OPZTYQ5F.js");
    case "./translations/pl.json":
      return import("./pl.json-KIA6EPL4.js");
    case "./translations/pt-BR.json":
      return import("./pt-BR.json-6GSTCGDQ.js");
    case "./translations/pt.json":
      return import("./pt.json-TC5QVEJX.js");
    case "./translations/ru.json":
      return import("./ru.json-626W5GSD.js");
    case "./translations/sk.json":
      return import("./sk.json-3JI2YCKF.js");
    case "./translations/th.json":
      return import("./th.json-Z6CZT4Y2.js");
    case "./translations/tr.json":
      return import("./tr.json-MLYUSLWC.js");
    case "./translations/uk.json":
      return import("./uk.json-L5EGH2OL.js");
    case "./translations/vi.json":
      return import("./vi.json-PPZALNIY.js");
    case "./translations/zh-Hans.json":
      return import("./zh-Hans.json-RVHRMTOJ.js");
    case "./translations/zh.json":
      return import("./zh.json-4S7OU5HD.js");
    default:
      return new Promise(function(resolve, reject) {
        (typeof queueMicrotask === "function" ? queueMicrotask : setTimeout)(
          reject.bind(null, new Error("Unknown variable dynamic import: " + path))
        );
      });
  }
}
var admin2 = {
  // TODO typing app in strapi/types as every plugin needs it
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  register(app) {
    app.createSettingSection({
      id: "email",
      intlLabel: {
        id: "email.SettingsNav.section-label",
        defaultMessage: "Email Plugin"
      }
    }, [
      {
        intlLabel: {
          id: "email.Settings.email.plugin.title",
          defaultMessage: "Settings"
        },
        id: "settings",
        to: "email",
        Component: () => import("./Settings-BUFBKFBH.js").then((mod) => ({
          default: mod.ProtectedSettingsPage
        })),
        permissions: PERMISSIONS.settings
      }
    ]);
    app.registerPlugin({
      id: "email",
      name: "email"
    });
  },
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  bootstrap() {
  },
  async registerTrads({ locales }) {
    const importedTrads = await Promise.all(locales.map((locale) => {
      return __variableDynamicImportRuntime1__(`./translations/${locale}.json`).then(({ default: data }) => {
        return {
          data: prefixPluginTranslations(data, "email"),
          locale
        };
      }).catch(() => {
        return {
          data: {},
          locale
        };
      });
    }));
    return Promise.resolve(importedTrads);
  }
};

// node_modules/@strapi/i18n/dist/admin/index.mjs
var import_get2 = __toESM(require_get(), 1);

// node_modules/@strapi/i18n/dist/admin/components/CheckboxConfirmation.mjs
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
var React = __toESM(require_react(), 1);
var TextAlignTypography = at(Typography)`
  text-align: center;
`;
var CheckboxConfirmation = ({ description, isCreating = false, intlLabel, name, onChange, value }) => {
  const { formatMessage } = useIntl();
  const [isOpen, setIsOpen] = React.useState(false);
  const handleChange = (value2) => {
    if (isCreating || value2) {
      return onChange({
        target: {
          name,
          value: value2,
          type: "checkbox"
        }
      });
    }
    if (!value2) {
      return setIsOpen(true);
    }
    return null;
  };
  const handleConfirm = () => {
    onChange({
      target: {
        name,
        value: false,
        type: "checkbox"
      }
    });
  };
  const label = intlLabel.id ? formatMessage({
    id: intlLabel.id,
    defaultMessage: intlLabel.defaultMessage
  }, {
    ...intlLabel.values
  }) : name;
  const hint = description ? formatMessage({
    id: description.id,
    defaultMessage: description.defaultMessage
  }, {
    ...description.values
  }) : "";
  return (0, import_jsx_runtime.jsxs)(Dialog.Root, {
    open: isOpen,
    onOpenChange: setIsOpen,
    children: [
      (0, import_jsx_runtime.jsxs)(Field.Root, {
        hint,
        name,
        children: [
          (0, import_jsx_runtime.jsx)(CheckboxImpl, {
            onCheckedChange: handleChange,
            checked: value,
            children: label
          }),
          (0, import_jsx_runtime.jsx)(Field.Hint, {})
        ]
      }),
      (0, import_jsx_runtime.jsxs)(Dialog.Content, {
        children: [
          (0, import_jsx_runtime.jsx)(Dialog.Header, {
            children: formatMessage({
              id: getTranslation("CheckboxConfirmation.Modal.title"),
              defaultMessage: "Disable localization"
            })
          }),
          (0, import_jsx_runtime.jsx)(Dialog.Body, {
            icon: (0, import_jsx_runtime.jsx)(ForwardRef$5, {}),
            children: (0, import_jsx_runtime.jsxs)(Flex, {
              direction: "column",
              alignItems: "stretch",
              gap: 2,
              children: [
                (0, import_jsx_runtime.jsx)(Flex, {
                  justifyContent: "center",
                  children: (0, import_jsx_runtime.jsx)(TextAlignTypography, {
                    children: formatMessage({
                      id: getTranslation("CheckboxConfirmation.Modal.content"),
                      defaultMessage: "Disabling localization will engender the deletion of all your content but the one associated to your default locale (if existing)."
                    })
                  })
                }),
                (0, import_jsx_runtime.jsx)(Flex, {
                  justifyContent: "center",
                  children: (0, import_jsx_runtime.jsx)(Typography, {
                    fontWeight: "semiBold",
                    children: formatMessage({
                      id: getTranslation("CheckboxConfirmation.Modal.body"),
                      defaultMessage: "Do you want to disable it?"
                    })
                  })
                })
              ]
            })
          }),
          (0, import_jsx_runtime.jsxs)(Dialog.Footer, {
            children: [
              (0, import_jsx_runtime.jsx)(Dialog.Cancel, {
                children: (0, import_jsx_runtime.jsx)(Button, {
                  variant: "tertiary",
                  children: formatMessage({
                    id: "components.popUpWarning.button.cancel",
                    defaultMessage: "No, cancel"
                  })
                })
              }),
              (0, import_jsx_runtime.jsx)(Dialog.Action, {
                children: (0, import_jsx_runtime.jsx)(Button, {
                  variant: "danger-light",
                  onClick: handleConfirm,
                  children: formatMessage({
                    id: getTranslation("CheckboxConfirmation.Modal.button-confirm"),
                    defaultMessage: "Yes, disable"
                  })
                })
              })
            ]
          })
        ]
      })
    ]
  });
};

// node_modules/@strapi/i18n/dist/admin/components/CMHeaderActions.mjs
var import_jsx_runtime3 = __toESM(require_jsx_runtime(), 1);
var React3 = __toESM(require_react(), 1);

// node_modules/@strapi/i18n/dist/admin/hooks/useI18n.mjs
var React2 = __toESM(require_react(), 1);

// node_modules/@strapi/i18n/dist/admin/utils/fields.mjs
var import_has = __toESM(require_has(), 1);
var LOCALIZED_FIELDS = [
  "biginteger",
  "boolean",
  "component",
  "date",
  "datetime",
  "decimal",
  "dynamiczone",
  "email",
  "enumeration",
  "float",
  "integer",
  "json",
  "media",
  "number",
  "password",
  "richtext",
  "blocks",
  "string",
  "text",
  "time"
];
var doesPluginOptionsHaveI18nLocalized = (opts) => (0, import_has.default)(opts, [
  "i18n",
  "localized"
]);

// node_modules/@strapi/i18n/dist/admin/utils/strings.mjs
var capitalize = (str) => str.charAt(0).toUpperCase() + str.slice(1);

// node_modules/@strapi/i18n/dist/admin/hooks/useI18n.mjs
var useI18n = () => {
  const params = useParams();
  const userPermissions = useAuth("useI18n", (state) => state.permissions);
  const actions = React2.useMemo(() => {
    const permissions = userPermissions.filter((permission) => permission.subject === params.slug);
    return permissions.reduce((acc, permission) => {
      var _a;
      const [actionShorthand] = permission.action.split(".").slice(-1);
      return {
        ...acc,
        [`can${capitalize(actionShorthand)}`]: ((_a = permission.properties) == null ? void 0 : _a.locales) ?? []
      };
    }, {
      canCreate: [],
      canRead: [],
      canUpdate: [],
      canDelete: [],
      canPublish: []
    });
  }, [
    params.slug,
    userPermissions
  ]);
  const { schema } = useDocument({
    // We can non-null assert these because below we skip the query if they are not present
    collectionType: params.collectionType,
    model: params.slug
  }, {
    skip: true
  });
  if (doesPluginOptionsHaveI18nLocalized(schema == null ? void 0 : schema.pluginOptions)) {
    return {
      hasI18n: schema.pluginOptions.i18n.localized,
      ...actions
    };
  }
  return {
    hasI18n: false,
    ...actions
  };
};

// node_modules/@strapi/i18n/dist/admin/services/relations.mjs
var relationsApi = i18nApi.injectEndpoints({
  overrideExisting: true,
  endpoints: (builder) => ({
    getManyDraftRelationCount: builder.query({
      query: ({ model, ...params }) => ({
        url: `/content-manager/collection-types/${model}/actions/countManyEntriesDraftRelations`,
        method: "GET",
        config: {
          params
        }
      }),
      transformResponse: (response) => response.data
    })
  })
});
var { useGetManyDraftRelationCountQuery } = relationsApi;

// node_modules/@strapi/i18n/dist/admin/utils/clean.mjs
var cleanData = (data, schema, components) => {
  const cleanedData = removeFields(data, [
    "createdAt",
    "createdBy",
    "updatedAt",
    "updatedBy",
    "id",
    "documentId",
    "publishedAt",
    "strapi_stage",
    "strapi_assignee",
    "locale",
    "status"
  ]);
  const cleanedDataWithoutPasswordAndRelation = recursiveRemoveFieldTypes(cleanedData, schema, components, [
    "relation",
    "password"
  ]);
  return cleanedDataWithoutPasswordAndRelation;
};
var removeFields = (data, fields) => {
  return Object.keys(data).reduce((acc, current) => {
    if (fields.includes(current)) {
      return acc;
    }
    acc[current] = data[current];
    return acc;
  }, {});
};
var recursiveRemoveFieldTypes = (data, schema, components, fields) => {
  return Object.keys(data).reduce((acc, current) => {
    const attribute = schema.attributes[current] ?? {
      type: void 0
    };
    if (fields.includes(attribute.type)) {
      return acc;
    }
    if (attribute.type === "dynamiczone") {
      acc[current] = data[current].map((componentValue, index4) => {
        const { id: _, ...rest } = recursiveRemoveFieldTypes(componentValue, components[componentValue.__component], components, fields);
        return {
          ...rest,
          __temp_key__: index4 + 1
        };
      });
    } else if (attribute.type === "component") {
      const { repeatable, component } = attribute;
      if (repeatable) {
        acc[current] = (data[current] ?? []).map((compoData, index4) => {
          const { id: _, ...rest } = recursiveRemoveFieldTypes(compoData, components[component], components, fields);
          return {
            ...rest,
            __temp_key__: index4 + 1
          };
        });
      } else {
        const { id: _, ...rest } = recursiveRemoveFieldTypes(data[current] ?? {}, components[component], components, fields);
        acc[current] = rest;
      }
    } else {
      acc[current] = data[current];
    }
    return acc;
  }, {});
};

// node_modules/@strapi/i18n/dist/admin/components/BulkLocaleActionModal.mjs
var import_jsx_runtime2 = __toESM(require_jsx_runtime(), 1);
var import_react = __toESM(require_react(), 1);
var import_qs = __toESM(require_lib(), 1);
var isErrorMessageDescriptor = (object) => {
  return typeof object === "object" && object !== null && "id" in object && "defaultMessage" in object;
};
var EntryValidationText = ({ status = "draft", validationErrors, action }) => {
  const { formatMessage } = useIntl();
  const getErrorStr = (key, value) => {
    if (typeof value === "string") {
      return `${key}: ${value}`;
    } else if (isErrorMessageDescriptor(value)) {
      return `${key}: ${formatMessage(value)}`;
    } else if (Array.isArray(value)) {
      return value.map((v) => getErrorStr(key, v)).join(" ");
    } else if (typeof value === "object" && !Array.isArray(value)) {
      return Object.entries(value).map(([k, v]) => getErrorStr(k, v)).join(" ");
    } else {
      return "";
    }
  };
  if (validationErrors) {
    const validationErrorsMessages = Object.entries(validationErrors).map(([key, value]) => {
      return getErrorStr(key, value);
    }).join(" ");
    return (0, import_jsx_runtime2.jsxs)(Flex, {
      gap: 2,
      children: [
        (0, import_jsx_runtime2.jsx)(ForwardRef$4b, {
          fill: "danger600"
        }),
        (0, import_jsx_runtime2.jsx)(TooltipImpl, {
          label: validationErrorsMessages,
          children: (0, import_jsx_runtime2.jsx)(Typography, {
            maxWidth: "30rem",
            textColor: "danger600",
            variant: "omega",
            fontWeight: "semiBold",
            ellipsis: true,
            children: validationErrorsMessages
          })
        })
      ]
    });
  }
  const getStatusMessage = () => {
    if (action === "bulk-publish") {
      if (status === "published") {
        return {
          icon: (0, import_jsx_runtime2.jsx)(ForwardRef$4L, {
            fill: "success600"
          }),
          text: formatMessage({
            id: "content-manager.bulk-publish.already-published",
            defaultMessage: "Already Published"
          }),
          textColor: "success600",
          fontWeight: "bold"
        };
      } else if (status === "modified") {
        return {
          icon: (0, import_jsx_runtime2.jsx)(ForwardRef$5h, {
            fill: "alternative600"
          }),
          text: formatMessage({
            id: "app.utils.ready-to-publish-changes",
            defaultMessage: "Ready to publish changes"
          })
        };
      } else {
        return {
          icon: (0, import_jsx_runtime2.jsx)(ForwardRef$4L, {
            fill: "success600"
          }),
          text: formatMessage({
            id: "app.utils.ready-to-publish",
            defaultMessage: "Ready to publish"
          })
        };
      }
    } else {
      if (status === "draft") {
        return {
          icon: (0, import_jsx_runtime2.jsx)(ForwardRef$4L, {
            fill: "success600"
          }),
          text: formatMessage({
            id: "content-manager.bulk-unpublish.already-unpublished",
            defaultMessage: "Already Unpublished"
          }),
          textColor: "success600",
          fontWeight: "bold"
        };
      } else {
        return {
          icon: (0, import_jsx_runtime2.jsx)(ForwardRef$4L, {
            fill: "success600"
          }),
          text: formatMessage({
            id: "app.utils.ready-to-unpublish-changes",
            defaultMessage: "Ready to unpublish"
          }),
          textColor: "success600",
          fontWeight: "bold"
        };
      }
    }
  };
  const { icon, text, textColor = "success600", fontWeight = "normal" } = getStatusMessage();
  return (0, import_jsx_runtime2.jsxs)(Flex, {
    gap: 2,
    children: [
      icon,
      (0, import_jsx_runtime2.jsx)(Typography, {
        textColor,
        fontWeight,
        children: text
      })
    ]
  });
};
var BoldChunk = (chunks) => (0, import_jsx_runtime2.jsx)(Typography, {
  fontWeight: "bold",
  children: chunks
});
var BulkLocaleActionModal = ({ headers, rows, localesMetadata, validationErrors = {}, action }) => {
  const { formatMessage } = useIntl();
  const selectedRows = useTable("BulkLocaleActionModal", (state) => state.selectedRows);
  const getFormattedCountMessage = () => {
    const currentStatusByLocale = rows.reduce((acc, { locale, status }) => {
      acc[locale] = status;
      return acc;
    }, {});
    const localesWithErrors = Object.keys(validationErrors);
    const publishedCount = selectedRows.filter(({ locale }) => currentStatusByLocale[locale] === "published").length;
    const draftCount = selectedRows.filter(({ locale }) => (currentStatusByLocale[locale] === "draft" || currentStatusByLocale[locale] === "modified") && !localesWithErrors.includes(locale)).length;
    const withErrorsCount = localesWithErrors.length;
    const messageId = action === "bulk-publish" ? "content-manager.containers.list.selectedEntriesModal.selectedCount.publish" : "content-manager.containers.list.selectedEntriesModal.selectedCount.unpublish";
    const defaultMessage = action === "bulk-publish" ? "<b>{publishedCount}</b> {publishedCount, plural, =0 {entries} one {entry} other {entries}} already published. <b>{draftCount}</b> {draftCount, plural, =0 {entries} one {entry} other {entries}} ready to publish. <b>{withErrorsCount}</b> {withErrorsCount, plural, =0 {entries} one {entry} other {entries}} waiting for action." : "<b>{draftCount}</b> {draftCount, plural, =0 {entries} one {entry} other {entries}} already unpublished. <b>{publishedCount}</b> {publishedCount, plural, =0 {entries} one {entry} other {entries}} ready to unpublish.";
    return formatMessage({
      id: messageId,
      defaultMessage
    }, {
      withErrorsCount,
      draftCount,
      publishedCount,
      b: BoldChunk
    });
  };
  return (0, import_jsx_runtime2.jsxs)(Modal.Body, {
    children: [
      (0, import_jsx_runtime2.jsx)(Typography, {
        children: getFormattedCountMessage()
      }),
      (0, import_jsx_runtime2.jsx)(Box, {
        marginTop: 5,
        children: (0, import_jsx_runtime2.jsxs)(Table.Content, {
          children: [
            (0, import_jsx_runtime2.jsxs)(Table.Head, {
              children: [
                (0, import_jsx_runtime2.jsx)(Table.HeaderCheckboxCell, {}),
                headers.map((head) => (0, import_jsx_runtime2.jsx)(Table.HeaderCell, {
                  ...head
                }, head.name))
              ]
            }),
            (0, import_jsx_runtime2.jsx)(Table.Body, {
              children: rows.map(({ locale, status }, index4) => {
                var _a;
                const error = (validationErrors == null ? void 0 : validationErrors[locale]) ?? null;
                const statusVariant = status === "draft" ? "primary" : status === "published" ? "success" : "alternative";
                return (0, import_jsx_runtime2.jsxs)(Table.Row, {
                  children: [
                    (0, import_jsx_runtime2.jsx)(Table.CheckboxCell, {
                      id: locale,
                      "aria-label": `Select ${locale}`
                    }),
                    (0, import_jsx_runtime2.jsx)(Table.Cell, {
                      children: (0, import_jsx_runtime2.jsx)(Typography, {
                        variant: "sigma",
                        textColor: "neutral600",
                        children: Array.isArray(localesMetadata) ? (_a = localesMetadata.find((localeEntry) => localeEntry.code === locale)) == null ? void 0 : _a.name : locale
                      })
                    }),
                    (0, import_jsx_runtime2.jsx)(Table.Cell, {
                      children: (0, import_jsx_runtime2.jsx)(Box, {
                        display: "flex",
                        children: (0, import_jsx_runtime2.jsx)(Status, {
                          display: "flex",
                          paddingLeft: "6px",
                          paddingRight: "6px",
                          paddingTop: "2px",
                          paddingBottom: "2px",
                          size: "S",
                          variant: statusVariant,
                          children: (0, import_jsx_runtime2.jsx)(Typography, {
                            tag: "span",
                            variant: "pi",
                            fontWeight: "bold",
                            children: capitalize(status)
                          })
                        })
                      })
                    }),
                    (0, import_jsx_runtime2.jsx)(Table.Cell, {
                      children: (0, import_jsx_runtime2.jsx)(EntryValidationText, {
                        validationErrors: error,
                        status,
                        action
                      })
                    }),
                    (0, import_jsx_runtime2.jsx)(Table.Cell, {
                      children: (0, import_jsx_runtime2.jsx)(IconButton, {
                        tag: Link,
                        to: {
                          search: (0, import_qs.stringify)({
                            plugins: {
                              i18n: {
                                locale
                              }
                            }
                          })
                        },
                        label: formatMessage({
                          id: getTranslation("Settings.list.actions.edit"),
                          defaultMessage: "Edit {name} locale"
                        }, {
                          name: locale
                        }),
                        variant: "ghost",
                        children: (0, import_jsx_runtime2.jsx)(ForwardRef$1z, {})
                      })
                    })
                  ]
                }, index4);
              })
            })
          ]
        })
      })
    ]
  });
};

// node_modules/@strapi/i18n/dist/admin/components/CMHeaderActions.mjs
var statusVariants = {
  draft: "secondary",
  published: "success",
  modified: "alternative"
};
var LocaleOption = ({ isDraftAndPublishEnabled, locale, status, entryExists }) => {
  const { formatMessage } = useIntl();
  if (!entryExists) {
    return formatMessage({
      id: getTranslation("CMEditViewLocalePicker.locale.create"),
      defaultMessage: "Create <bold>{locale}</bold> locale"
    }, {
      bold: (locale2) => (0, import_jsx_runtime3.jsx)("b", {
        children: locale2
      }),
      locale: locale.name
    });
  }
  return (0, import_jsx_runtime3.jsxs)(Flex, {
    width: "100%",
    gap: 1,
    justifyContent: "space-between",
    children: [
      (0, import_jsx_runtime3.jsx)(Typography, {
        children: locale.name
      }),
      isDraftAndPublishEnabled ? (0, import_jsx_runtime3.jsx)(Status, {
        display: "flex",
        paddingLeft: "6px",
        paddingRight: "6px",
        paddingTop: "2px",
        paddingBottom: "2px",
        size: "S",
        variant: statusVariants[status],
        children: (0, import_jsx_runtime3.jsx)(Typography, {
          tag: "span",
          variant: "pi",
          fontWeight: "bold",
          children: capitalize(status)
        })
      }) : null
    ]
  });
};
var LocalePickerAction = ({ document, meta, model, collectionType, documentId }) => {
  var _a, _b;
  const { formatMessage } = useIntl();
  const [{ query }, setQuery] = useQueryParams();
  const { hasI18n, canCreate, canRead } = useI18n();
  const { data: locales = [] } = useGetLocalesQuery();
  const currentDesiredLocale = (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale;
  const { schema } = useDocument({
    model,
    collectionType,
    documentId,
    params: {
      locale: currentDesiredLocale
    }
  });
  const handleSelect = React3.useCallback((value) => {
    setQuery({
      plugins: {
        ...query.plugins,
        i18n: {
          locale: value
        }
      }
    });
  }, [
    query.plugins,
    setQuery
  ]);
  React3.useEffect(() => {
    if (!Array.isArray(locales) || !hasI18n) {
      return;
    }
    const doesLocaleExist = locales.find((loc) => loc.code === currentDesiredLocale);
    const defaultLocale = locales.find((locale) => locale.isDefault);
    if (!doesLocaleExist && (defaultLocale == null ? void 0 : defaultLocale.code)) {
      handleSelect(defaultLocale.code);
    }
  }, [
    handleSelect,
    hasI18n,
    locales,
    currentDesiredLocale
  ]);
  const currentLocale = Array.isArray(locales) ? locales.find((locale) => locale.code === currentDesiredLocale) : void 0;
  const allCurrentLocales = [
    {
      status: getDocumentStatus(document, meta),
      locale: currentLocale == null ? void 0 : currentLocale.code
    },
    ...(document == null ? void 0 : document.localizations) ?? []
  ];
  if (!hasI18n || !Array.isArray(locales) || locales.length === 0) {
    return null;
  }
  const displayedLocales = locales.filter((locale) => {
    return canRead.includes(locale.code);
  });
  return {
    label: formatMessage({
      id: getTranslation("Settings.locales.modal.locales.label"),
      defaultMessage: "Locales"
    }),
    options: displayedLocales.map((locale) => {
      var _a2;
      const entryWithLocaleExists = allCurrentLocales.some((doc) => doc.locale === locale.code);
      const currentLocaleDoc = allCurrentLocales.find((doc) => "locale" in doc ? doc.locale === locale.code : false);
      const permissionsToCheck = currentLocaleDoc ? canRead : canCreate;
      return {
        disabled: !permissionsToCheck.includes(locale.code),
        value: locale.code,
        label: (0, import_jsx_runtime3.jsx)(LocaleOption, {
          isDraftAndPublishEnabled: !!((_a2 = schema == null ? void 0 : schema.options) == null ? void 0 : _a2.draftAndPublish),
          locale,
          status: currentLocaleDoc == null ? void 0 : currentLocaleDoc.status,
          entryExists: entryWithLocaleExists
        }),
        startIcon: !entryWithLocaleExists ? (0, import_jsx_runtime3.jsx)(ForwardRef$1l, {}) : null
      };
    }),
    customizeContent: () => currentLocale == null ? void 0 : currentLocale.name,
    onSelect: handleSelect,
    value: currentLocale
  };
};
var getDocumentStatus = (document, meta) => {
  const docStatus = document == null ? void 0 : document.status;
  const statuses = (meta == null ? void 0 : meta.availableStatus) ?? [];
  if (!docStatus) {
    return "draft";
  }
  if (docStatus === "draft" && statuses.find((doc) => doc.publishedAt !== null)) {
    return "published";
  }
  return docStatus;
};
var FillFromAnotherLocaleAction = ({ documentId, meta, model, collectionType }) => {
  var _a, _b;
  const { formatMessage } = useIntl();
  const [{ query }] = useQueryParams();
  const { hasI18n } = useI18n();
  const currentDesiredLocale = (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale;
  const [localeSelected, setLocaleSelected] = React3.useState(null);
  const setValues = useForm("FillFromAnotherLocale", (state) => state.setValues);
  const { getDocument } = useDocumentActions();
  const { schema, components } = useDocument({
    model,
    documentId,
    collectionType,
    params: {
      locale: currentDesiredLocale
    }
  });
  const { data: locales = [] } = useGetLocalesQuery();
  const availableLocales = Array.isArray(locales) ? locales.filter((locale) => meta == null ? void 0 : meta.availableLocales.some((l) => l.locale === locale.code)) : [];
  const fillFromLocale = (onClose) => async () => {
    const response = await getDocument({
      collectionType,
      model,
      documentId,
      params: {
        locale: localeSelected
      }
    });
    if (!response || !schema) {
      return;
    }
    const { data } = response;
    const cleanedData = cleanData(data, schema, components);
    setValues(cleanedData);
    onClose();
  };
  if (!hasI18n) {
    return null;
  }
  return {
    type: "icon",
    icon: (0, import_jsx_runtime3.jsx)(ForwardRef$3X, {}),
    disabled: availableLocales.length === 0,
    label: formatMessage({
      id: getTranslation("CMEditViewCopyLocale.copy-text"),
      defaultMessage: "Fill in from another locale"
    }),
    dialog: {
      type: "dialog",
      title: formatMessage({
        id: getTranslation("CMEditViewCopyLocale.dialog.title"),
        defaultMessage: "Confirmation"
      }),
      content: ({ onClose }) => (0, import_jsx_runtime3.jsxs)(import_jsx_runtime3.Fragment, {
        children: [
          (0, import_jsx_runtime3.jsx)(Dialog.Body, {
            children: (0, import_jsx_runtime3.jsxs)(Flex, {
              direction: "column",
              gap: 3,
              children: [
                (0, import_jsx_runtime3.jsx)(ForwardRef$5, {
                  width: "24px",
                  height: "24px",
                  fill: "danger600"
                }),
                (0, import_jsx_runtime3.jsx)(Typography, {
                  textAlign: "center",
                  children: formatMessage({
                    id: getTranslation("CMEditViewCopyLocale.dialog.body"),
                    defaultMessage: "Your current content will be erased and filled by the content of the selected locale:"
                  })
                }),
                (0, import_jsx_runtime3.jsxs)(Field.Root, {
                  width: "100%",
                  children: [
                    (0, import_jsx_runtime3.jsx)(Field.Label, {
                      children: formatMessage({
                        id: getTranslation("CMEditViewCopyLocale.dialog.field.label"),
                        defaultMessage: "Locale"
                      })
                    }),
                    (0, import_jsx_runtime3.jsx)(SingleSelect, {
                      value: localeSelected,
                      placeholder: formatMessage({
                        id: getTranslation("CMEditViewCopyLocale.dialog.field.placeholder"),
                        defaultMessage: "Select one locale..."
                      }),
                      // @ts-expect-error â€“ the DS will handle numbers, but we're not allowing the API.
                      onChange: (value) => setLocaleSelected(value),
                      children: availableLocales.map((locale) => (0, import_jsx_runtime3.jsx)(SingleSelectOption, {
                        value: locale.code,
                        children: locale.name
                      }, locale.code))
                    })
                  ]
                })
              ]
            })
          }),
          (0, import_jsx_runtime3.jsx)(Dialog.Footer, {
            children: (0, import_jsx_runtime3.jsxs)(Flex, {
              gap: 2,
              width: "100%",
              children: [
                (0, import_jsx_runtime3.jsx)(Button, {
                  flex: "auto",
                  variant: "tertiary",
                  onClick: onClose,
                  children: formatMessage({
                    id: getTranslation("CMEditViewCopyLocale.cancel-text"),
                    defaultMessage: "No, cancel"
                  })
                }),
                (0, import_jsx_runtime3.jsx)(Button, {
                  flex: "auto",
                  variant: "success",
                  onClick: fillFromLocale(onClose),
                  children: formatMessage({
                    id: getTranslation("CMEditViewCopyLocale.submit-text"),
                    defaultMessage: "Yes, fill in"
                  })
                })
              ]
            })
          })
        ]
      })
    }
  };
};
var DeleteLocaleAction = ({ document, documentId, model, collectionType }) => {
  var _a, _b;
  const { formatMessage } = useIntl();
  const navigate = useNavigate();
  const { toggleNotification } = useNotification();
  const { delete: deleteAction, isLoading } = useDocumentActions();
  const { hasI18n, canDelete } = useI18n();
  const [{ query }] = useQueryParams();
  const { data: locales = [] } = useGetLocalesQuery();
  const currentDesiredLocale = (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale;
  const locale = !("error" in locales) && locales.find((loc) => loc.code === currentDesiredLocale);
  if (!hasI18n) {
    return null;
  }
  return {
    disabled: (document == null ? void 0 : document.locale) && !canDelete.includes(document.locale) || !document || !document.id,
    position: [
      "header",
      "table-row"
    ],
    label: formatMessage({
      id: getTranslation("actions.delete.label"),
      defaultMessage: "Delete entry ({locale})"
    }, {
      locale: locale && locale.name
    }),
    icon: (0, import_jsx_runtime3.jsx)(StyledTrash, {}),
    variant: "danger",
    dialog: {
      type: "dialog",
      title: formatMessage({
        id: getTranslation("actions.delete.dialog.title"),
        defaultMessage: "Confirmation"
      }),
      content: (0, import_jsx_runtime3.jsxs)(Flex, {
        direction: "column",
        gap: 2,
        children: [
          (0, import_jsx_runtime3.jsx)(ForwardRef$5, {
            width: "24px",
            height: "24px",
            fill: "danger600"
          }),
          (0, import_jsx_runtime3.jsx)(Typography, {
            tag: "p",
            variant: "omega",
            textAlign: "center",
            children: formatMessage({
              id: getTranslation("actions.delete.dialog.body"),
              defaultMessage: "Are you sure?"
            })
          })
        ]
      }),
      loading: isLoading,
      onConfirm: async () => {
        const unableToDelete = (
          // We are unable to delete a collection type without a document ID
          // & unable to delete generally if there is no document locale
          collectionType !== "single-types" && !documentId || !(document == null ? void 0 : document.locale)
        );
        if (unableToDelete) {
          console.error("You're trying to delete a document without an id or locale, this is likely a bug with Strapi. Please open an issue.");
          toggleNotification({
            message: formatMessage({
              id: getTranslation("actions.delete.error"),
              defaultMessage: "An error occurred while trying to delete the document locale."
            }),
            type: "danger"
          });
          return;
        }
        const res = await deleteAction({
          documentId,
          model,
          collectionType,
          params: {
            locale: document.locale
          }
        });
        if (!("error" in res)) {
          navigate({
            pathname: `../${collectionType}/${model}`
          }, {
            replace: true
          });
        }
      }
    }
  };
};
var BulkLocaleAction = ({ document, documentId, model, collectionType, action }) => {
  var _a;
  const locale = (document == null ? void 0 : document.locale) ?? null;
  const [{ query }] = useQueryParams();
  const params = React3.useMemo(() => buildValidParams(query), [
    query
  ]);
  const isOnPublishedTab = query.status === "published";
  const { formatMessage } = useIntl();
  const { hasI18n, canPublish } = useI18n();
  const { toggleNotification } = useNotification();
  const { _unstableFormatAPIError: formatAPIError } = useAPIErrorHandler();
  const [selectedRows, setSelectedRows] = React3.useState([]);
  const [isDraftRelationConfirmationOpen, setIsDraftRelationConfirmationOpen] = React3.useState(false);
  const { publishMany: publishManyAction, unpublishMany: unpublishManyAction } = useDocumentActions();
  const { schema, validate } = useDocument({
    model,
    collectionType,
    documentId,
    params: {
      locale
    }
  }, {
    // No need to fetch the document, the data is already available in the `document` prop
    skip: true
  });
  const { data: localesMetadata = [] } = useGetLocalesQuery(hasI18n ? void 0 : skipToken);
  const headers = [
    {
      label: formatMessage({
        id: "global.name",
        defaultMessage: "Name"
      }),
      name: "name"
    },
    {
      label: formatMessage({
        id: getTranslation("CMEditViewBulkLocale.status"),
        defaultMessage: "Status"
      }),
      name: "status"
    },
    {
      label: formatMessage({
        id: getTranslation("CMEditViewBulkLocale.publication-status"),
        defaultMessage: "Publication Status"
      }),
      name: "publication-status"
    }
  ];
  const [rows, validationErrors] = React3.useMemo(() => {
    if (!document) {
      return [
        [],
        {}
      ];
    }
    const localizations = document.localizations ?? [];
    const locales = localizations.map((doc) => {
      const { locale: locale2, status } = doc;
      return {
        locale: locale2,
        status
      };
    });
    locales.unshift({
      locale: document.locale,
      status: document.status
    });
    const allDocuments = [
      document,
      ...localizations
    ];
    const errors = allDocuments.reduce((errs, document2) => {
      if (!document2) {
        return errs;
      }
      const validation = validate(document2);
      if (validation !== null) {
        errs[document2.locale] = validation;
      }
      return errs;
    }, {});
    return [
      locales,
      errors
    ];
  }, [
    document,
    validate
  ]);
  const isBulkPublish = action === "bulk-publish";
  const localesForAction = selectedRows.reduce((acc, selectedRow) => {
    const isValidLocale = (
      // Validation errors are irrelevant if we are trying to unpublish
      !isBulkPublish || !Object.keys(validationErrors).includes(selectedRow.locale)
    );
    const shouldAddLocale = isBulkPublish ? selectedRow.status !== "published" && isValidLocale : selectedRow.status !== "draft" && isValidLocale;
    if (shouldAddLocale) {
      acc.push(selectedRow.locale);
    }
    return acc;
  }, []);
  const enableDraftRelationsCount = false;
  const { data: draftRelationsCount = 0, isLoading: isDraftRelationsLoading, error: isDraftRelationsError } = useGetManyDraftRelationCountQuery({
    model,
    documentIds: [
      documentId
    ],
    locale: localesForAction
  }, {
    skip: !enableDraftRelationsCount
  });
  React3.useEffect(() => {
    if (isDraftRelationsError) {
      toggleNotification({
        type: "danger",
        message: formatAPIError(isDraftRelationsError)
      });
    }
  }, [
    isDraftRelationsError,
    toggleNotification,
    formatAPIError
  ]);
  if (!((_a = schema == null ? void 0 : schema.options) == null ? void 0 : _a.draftAndPublish)) {
    return null;
  }
  if (!hasI18n) {
    return null;
  }
  if (!documentId) {
    return null;
  }
  const publish = async () => {
    await publishManyAction({
      model,
      documentIds: [
        documentId
      ],
      params: {
        ...params,
        locale: localesForAction
      }
    });
    setSelectedRows([]);
  };
  const unpublish = async () => {
    await unpublishManyAction({
      model,
      documentIds: [
        documentId
      ],
      params: {
        ...params,
        locale: localesForAction
      }
    });
    setSelectedRows([]);
  };
  const handleAction = async () => {
    if (draftRelationsCount > 0) {
      setIsDraftRelationConfirmationOpen(true);
    } else if (isBulkPublish) {
      await publish();
    } else {
      await unpublish();
    }
  };
  if (isDraftRelationConfirmationOpen) {
    return {
      label: formatMessage({
        id: "app.components.ConfirmDialog.title",
        defaultMessage: "Confirmation"
      }),
      variant: "danger",
      dialog: {
        onCancel: () => {
          setIsDraftRelationConfirmationOpen(false);
        },
        onConfirm: async () => {
          await publish();
          setIsDraftRelationConfirmationOpen(false);
        },
        type: "dialog",
        title: formatMessage({
          id: getTranslation("actions.publish.dialog.title"),
          defaultMessage: "Confirmation"
        }),
        content: (0, import_jsx_runtime3.jsxs)(Flex, {
          direction: "column",
          alignItems: "center",
          gap: 2,
          children: [
            (0, import_jsx_runtime3.jsx)(ForwardRef$5, {
              width: "2.4rem",
              height: "2.4rem",
              fill: "danger600"
            }),
            (0, import_jsx_runtime3.jsx)(Typography, {
              textAlign: "center",
              children: formatMessage({
                id: getTranslation("CMEditViewBulkLocale.draft-relation-warning"),
                defaultMessage: "Some locales are related to draft entries. Publishing them could leave broken links in your app."
              })
            }),
            (0, import_jsx_runtime3.jsx)(Typography, {
              textAlign: "center",
              children: formatMessage({
                id: getTranslation("CMEditViewBulkLocale.continue-confirmation"),
                defaultMessage: "Are you sure you want to continue?"
              })
            })
          ]
        })
      }
    };
  }
  const hasPermission = selectedRows.map(({ locale: locale2 }) => locale2).every((locale2) => canPublish.includes(locale2));
  return {
    label: formatMessage({
      id: getTranslation(`CMEditViewBulkLocale.${isBulkPublish ? "publish" : "unpublish"}-title`),
      defaultMessage: `${isBulkPublish ? "Publish" : "Unpublish"} Multiple Locales`
    }),
    variant: isBulkPublish ? "secondary" : "danger",
    icon: isBulkPublish ? (0, import_jsx_runtime3.jsx)(ForwardRef$2r, {}) : (0, import_jsx_runtime3.jsx)(ForwardRef$4d, {}),
    disabled: isOnPublishedTab || canPublish.length === 0,
    position: [
      "panel"
    ],
    dialog: {
      type: "modal",
      title: formatMessage({
        id: getTranslation(`CMEditViewBulkLocale.${isBulkPublish ? "publish" : "unpublish"}-title`),
        defaultMessage: `${isBulkPublish ? "Publish" : "Unpublish"} Multiple Locales`
      }),
      content: () => {
        return (0, import_jsx_runtime3.jsx)(Table.Root, {
          headers,
          rows: rows.map((row) => ({
            ...row,
            id: row.locale
          })),
          selectedRows,
          onSelectedRowsChange: (tableSelectedRows) => setSelectedRows(tableSelectedRows),
          children: (0, import_jsx_runtime3.jsx)(BulkLocaleActionModal, {
            validationErrors,
            headers,
            rows,
            localesMetadata,
            action: action ?? "bulk-publish"
          })
        });
      },
      footer: () => (0, import_jsx_runtime3.jsx)(Modal.Footer, {
        justifyContent: "flex-end",
        children: (0, import_jsx_runtime3.jsx)(Button, {
          loading: isDraftRelationsLoading,
          disabled: !hasPermission || localesForAction.length === 0,
          variant: "default",
          onClick: handleAction,
          children: formatMessage({
            id: isBulkPublish ? "app.utils.publish" : "app.utils.unpublish",
            defaultMessage: isBulkPublish ? "Publish" : "Unpublish"
          })
        })
      })
    }
  };
};
var BulkLocalePublishAction = (props) => {
  return BulkLocaleAction({
    action: "bulk-publish",
    ...props
  });
};
var BulkLocaleUnpublishAction = (props) => {
  return BulkLocaleAction({
    action: "bulk-unpublish",
    ...props
  });
};
var StyledTrash = at(ForwardRef$n)`
  path {
    fill: currentColor;
  }
`;

// node_modules/@strapi/i18n/dist/admin/components/CMListViewModalsAdditionalInformation.mjs
var import_jsx_runtime4 = __toESM(require_jsx_runtime(), 1);
var import_react2 = __toESM(require_react(), 1);
var Emphasis = (chunks) => {
  return (0, import_jsx_runtime4.jsx)(Typography, {
    fontWeight: "semiBold",
    textColor: "danger500",
    children: chunks
  });
};
var DeleteModalAdditionalInfo = () => {
  const { hasI18n } = useI18n();
  const { formatMessage } = useIntl();
  if (!hasI18n) {
    return null;
  }
  return (0, import_jsx_runtime4.jsx)(Typography, {
    textColor: "danger500",
    children: formatMessage({
      id: getTranslation("Settings.list.actions.deleteAdditionalInfos"),
      defaultMessage: "This will delete the active locale versions <em>(from Internationalization)</em>"
    }, {
      em: Emphasis
    })
  });
};
var PublishModalAdditionalInfo = () => {
  const { hasI18n } = useI18n();
  const { formatMessage } = useIntl();
  if (!hasI18n) {
    return null;
  }
  return (0, import_jsx_runtime4.jsx)(Typography, {
    textColor: "danger500",
    children: formatMessage({
      id: getTranslation("Settings.list.actions.publishAdditionalInfos"),
      defaultMessage: "This will publish the active locale versions <em>(from Internationalization)</em>"
    }, {
      em: Emphasis
    })
  });
};
var UnpublishModalAdditionalInfo = () => {
  const { hasI18n } = useI18n();
  const { formatMessage } = useIntl();
  if (!hasI18n) {
    return null;
  }
  return (0, import_jsx_runtime4.jsx)(Typography, {
    textColor: "danger500",
    children: formatMessage({
      id: getTranslation("Settings.list.actions.unpublishAdditionalInfos"),
      defaultMessage: "This will unpublish the active locale versions <em>(from Internationalization)</em>"
    }, {
      em: Emphasis
    })
  });
};

// node_modules/@strapi/i18n/dist/admin/components/LocalePicker.mjs
var import_jsx_runtime5 = __toESM(require_jsx_runtime(), 1);
var React4 = __toESM(require_react(), 1);
var LocalePicker = () => {
  var _a, _b, _c, _d, _e;
  const { formatMessage } = useIntl();
  const [{ query }, setQuery] = useQueryParams();
  const { hasI18n, canRead, canCreate } = useI18n();
  const { data: locales = [] } = useGetLocalesQuery(void 0, {
    skip: !hasI18n
  });
  const handleChange = React4.useCallback((code, replace = false) => {
    setQuery({
      page: 1,
      plugins: {
        ...query.plugins,
        i18n: {
          locale: code
        }
      }
    }, "push", replace);
  }, [
    query.plugins,
    setQuery
  ]);
  React4.useEffect(() => {
    var _a2, _b2;
    if (!Array.isArray(locales) || !hasI18n) {
      return;
    }
    const currentDesiredLocale = (_b2 = (_a2 = query.plugins) == null ? void 0 : _a2.i18n) == null ? void 0 : _b2.locale;
    const doesLocaleExist = locales.find((loc) => loc.code === currentDesiredLocale);
    const defaultLocale = locales.find((locale) => locale.isDefault);
    if (!doesLocaleExist && (defaultLocale == null ? void 0 : defaultLocale.code)) {
      handleChange(defaultLocale.code, true);
    }
  }, [
    hasI18n,
    handleChange,
    locales,
    (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale
  ]);
  if (!hasI18n || !Array.isArray(locales) || locales.length === 0) {
    return null;
  }
  const displayedLocales = locales.filter((locale) => {
    return canCreate.includes(locale.code) || canRead.includes(locale.code);
  });
  return (0, import_jsx_runtime5.jsx)(SingleSelect, {
    size: "S",
    "aria-label": formatMessage({
      id: getTranslation("actions.select-locale"),
      defaultMessage: "Select locale"
    }),
    value: ((_d = (_c = query.plugins) == null ? void 0 : _c.i18n) == null ? void 0 : _d.locale) || ((_e = locales.find((locale) => locale.isDefault)) == null ? void 0 : _e.code),
    // @ts-expect-error â€“ This can be removed in V2 of the DS.
    onChange: handleChange,
    children: displayedLocales.map((locale) => (0, import_jsx_runtime5.jsx)(SingleSelectOption, {
      value: locale.code,
      children: locale.name
    }, locale.id))
  });
};

// node_modules/@strapi/i18n/dist/admin/contentManagerHooks/editView.mjs
var import_jsx_runtime6 = __toESM(require_jsx_runtime(), 1);
var React5 = __toESM(require_react(), 1);
var mutateEditViewHook = ({ layout }) => {
  if (!("i18n" in layout.options) || typeof layout.options.i18n === "object" && layout.options.i18n !== null && "localized" in layout.options.i18n && !layout.options.i18n.localized) {
    return {
      layout
    };
  }
  const components = Object.entries(layout.components).reduce((acc, [key, componentLayout]) => {
    return {
      ...acc,
      [key]: {
        ...componentLayout,
        layout: componentLayout.layout.map((row) => row.map(addLabelActionToField))
      }
    };
  }, {});
  return {
    layout: {
      ...layout,
      components,
      layout: layout.layout.map((panel) => panel.map((row) => row.map(addLabelActionToField)))
    }
  };
};
var addLabelActionToField = (field) => {
  const isFieldLocalized = doesFieldHaveI18nPluginOpt(field.attribute.pluginOptions) ? field.attribute.pluginOptions.i18n.localized : true;
  const labelActionProps = {
    title: {
      id: isFieldLocalized ? getTranslation("Field.localized") : getTranslation("Field.not-localized"),
      defaultMessage: isFieldLocalized ? "This value is unique for the selected locale" : "This value is the same across all locales"
    },
    icon: isFieldLocalized ? (0, import_jsx_runtime6.jsx)(ForwardRef$3X, {}) : null
  };
  return {
    ...field,
    labelAction: isFieldLocalized ? (0, import_jsx_runtime6.jsx)(LabelAction, {
      ...labelActionProps
    }) : null
  };
};
var doesFieldHaveI18nPluginOpt = (pluginOpts) => {
  if (!pluginOpts) {
    return false;
  }
  return "i18n" in pluginOpts && typeof pluginOpts.i18n === "object" && pluginOpts.i18n !== null && "localized" in pluginOpts.i18n;
};
var LabelAction = ({ title, icon }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime6.jsxs)(Span, {
    tag: "span",
    children: [
      (0, import_jsx_runtime6.jsx)(VisuallyHidden, {
        tag: "span",
        children: formatMessage(title)
      }),
      React5.cloneElement(icon, {
        "aria-hidden": true,
        focusable: false
      })
    ]
  });
};
var Span = at(Flex)`
  svg {
    width: 12px;
    height: 12px;

    fill: ${({ theme }) => theme.colors.neutral500};

    path {
      fill: ${({ theme }) => theme.colors.neutral500};
    }
  }
`;

// node_modules/@strapi/i18n/dist/admin/contentManagerHooks/listView.mjs
var import_jsx_runtime8 = __toESM(require_jsx_runtime(), 1);

// node_modules/@strapi/i18n/dist/admin/components/LocaleListCell.mjs
var import_jsx_runtime7 = __toESM(require_jsx_runtime(), 1);
var LocaleListCell = ({ locale: currentLocale, localizations }) => {
  const { locale: language } = useIntl();
  const { data: locales = [] } = useGetLocalesQuery();
  const formatter = useCollator(language, {
    sensitivity: "base"
  });
  if (!Array.isArray(locales) || !localizations) {
    return null;
  }
  const availableLocales = localizations.map((loc) => loc.locale);
  const localesForDocument = locales.reduce((acc, locale) => {
    const createdLocale = [
      currentLocale,
      ...availableLocales
    ].find((loc) => {
      return loc === locale.code;
    });
    if (createdLocale) {
      acc.push(locale);
    }
    return acc;
  }, []).map((locale) => {
    if (locale.isDefault) {
      return `${locale.name} (default)`;
    }
    return locale.name;
  }).toSorted((a, b) => formatter.compare(a, b));
  return (0, import_jsx_runtime7.jsxs)(Popover.Root, {
    children: [
      (0, import_jsx_runtime7.jsx)(Popover.Trigger, {
        children: (0, import_jsx_runtime7.jsx)(Button, {
          variant: "ghost",
          type: "button",
          onClick: (e) => e.stopPropagation(),
          children: (0, import_jsx_runtime7.jsxs)(Flex, {
            minWidth: "100%",
            alignItems: "center",
            justifyContent: "center",
            fontWeight: "regular",
            children: [
              (0, import_jsx_runtime7.jsx)(Typography, {
                textColor: "neutral800",
                ellipsis: true,
                marginRight: 2,
                children: localesForDocument.join(", ")
              }),
              (0, import_jsx_runtime7.jsx)(Flex, {
                children: (0, import_jsx_runtime7.jsx)(ForwardRef$4$, {
                  width: "1.2rem",
                  height: "1.2rem"
                })
              })
            ]
          })
        })
      }),
      (0, import_jsx_runtime7.jsx)(Popover.Content, {
        sideOffset: 16,
        children: (0, import_jsx_runtime7.jsx)("ul", {
          children: localesForDocument.map((name) => (0, import_jsx_runtime7.jsx)(Box, {
            padding: 3,
            tag: "li",
            children: (0, import_jsx_runtime7.jsx)(Typography, {
              children: name
            })
          }, name))
        })
      })
    ]
  });
};

// node_modules/@strapi/i18n/dist/admin/contentManagerHooks/listView.mjs
var addColumnToTableHook = ({ displayedHeaders, layout }) => {
  const { options } = layout;
  const isFieldLocalized = doesPluginOptionsHaveI18nLocalized(options) ? options.i18n.localized : false;
  if (!isFieldLocalized) {
    return {
      displayedHeaders,
      layout
    };
  }
  return {
    displayedHeaders: [
      ...displayedHeaders,
      {
        attribute: {
          type: "string"
        },
        label: {
          id: getTranslation("list-view.table.header.label"),
          defaultMessage: "Available in"
        },
        searchable: false,
        sortable: false,
        name: "locales",
        // @ts-expect-error â€“ ID is seen as number | string; this will change when we move the type over.
        cellFormatter: (props, _header, meta) => (0, import_jsx_runtime8.jsx)(LocaleListCell, {
          ...props,
          ...meta
        })
      }
    ],
    layout
  };
};

// node_modules/@strapi/i18n/dist/admin/contentReleasesHooks/releaseDetailsView.mjs
var addLocaleToReleasesHook = ({ displayedHeaders = [] }) => {
  return {
    displayedHeaders: [
      ...displayedHeaders,
      {
        label: {
          id: "content-releases.page.ReleaseDetails.table.header.label.locale",
          defaultMessage: "locale"
        },
        name: "locale"
      }
    ],
    hasI18nEnabled: true
  };
};

// node_modules/@strapi/i18n/dist/admin/middlewares/extendCTBAttributeInitialData.mjs
var import_get = __toESM(require_get(), 1);
var extendCTBAttributeInitialDataMiddleware = () => {
  return ({ getState }) => (next) => (action) => {
    const enhanceAction = ({ uid }) => {
      var _a, _b;
      try {
        const store = getState();
        const type2 = (0, import_get.default)(store, [
          "content-type-builder_dataManagerProvider",
          "current",
          "contentTypes",
          uid
        ]);
        if (!type2 || type2.modelType !== "contentType") {
          return next(action);
        }
        const hasi18nEnabled = (0, import_get.default)(type2, [
          "pluginOptions",
          "i18n",
          "localized"
        ], false);
        if (hasi18nEnabled) {
          return next({
            ...action,
            payload: {
              ...action.payload,
              options: {
                pluginOptions: {
                  ...((_b = (_a = action == null ? void 0 : action.payload) == null ? void 0 : _a.options) == null ? void 0 : _b.pluginOptions) ?? {},
                  i18n: {
                    localized: true
                  }
                }
              }
            }
          });
        }
        return next(action);
      } catch (err) {
        return next(action);
      }
    };
    const { payload = {}, type } = action ?? {};
    if (type === "formModal/setAttributeDataSchema" && ![
      "relation",
      "component"
    ].includes(payload.attributeType) && !payload.isEditing) {
      return enhanceAction({
        uid: payload.uid
      });
    }
    if (type === "formModal/setCustomFieldDataSchema" && !payload.isEditing) {
      return enhanceAction({
        uid: payload.uid
      });
    }
    if (type === "formModal/resetPropsAndSetFormForAddingAnExistingCompo" || type === "formModal/resetPropsAndSaveCurrentData") {
      return enhanceAction({
        uid: payload.uid
      });
    }
    return next(action);
  };
};

// node_modules/@strapi/i18n/dist/admin/middlewares/extendCTBInitialData.mjs
var extendCTBInitialDataMiddleware = () => {
  return () => (next) => (action) => {
    var _a, _b;
    if (action.type === "ContentTypeBuilder/FormModal/SET_DATA_TO_EDIT" && action.modalType === "contentType") {
      const i18n = {
        localized: false
      };
      const pluginOptions = action.data.pluginOptions ? {
        ...action.data.pluginOptions,
        i18n
      } : {
        i18n
      };
      const data = {
        ...action.data,
        pluginOptions
      };
      if (action.actionType === "create") {
        return next({
          ...action,
          data
        });
      }
      if (!((_b = (_a = action.data.pluginOptions) == null ? void 0 : _a.i18n) == null ? void 0 : _b.localized)) {
        return next({
          ...action,
          data
        });
      }
    }
    return next(action);
  };
};

// node_modules/@strapi/i18n/dist/admin/middlewares/rbac-middleware.mjs
var qs = __toESM(require_lib(), 1);
var localeMiddleware = (ctx) => (next) => (permissions) => {
  const match = matchPath("/content-manager/:collectionType/:model?/:id", ctx.pathname);
  if (!match) {
    return next(permissions);
  }
  const search = qs.parse(ctx.search);
  if (typeof search !== "object") {
    return next(permissions);
  }
  if (!("plugins" in search && typeof search.plugins === "object")) {
    return next(permissions);
  }
  if (!("i18n" in search.plugins && typeof search.plugins.i18n === "object" && !Array.isArray(search.plugins.i18n))) {
    return next(permissions);
  }
  const { locale } = search.plugins.i18n;
  if (typeof locale !== "string") {
    return next(permissions);
  }
  const revisedPermissions = permissions.filter((permission) => {
    var _a;
    return !((_a = permission.properties) == null ? void 0 : _a.locales) || permission.properties.locales.includes(locale);
  });
  return next(revisedPermissions);
};

// node_modules/@strapi/i18n/dist/admin/utils/prefixPluginTranslations.mjs
var prefixPluginTranslations2 = (trad, pluginId3) => {
  return Object.keys(trad).reduce((acc, current) => {
    acc[`${pluginId3}.${current}`] = trad[current];
    return acc;
  }, {});
};

// node_modules/@strapi/i18n/dist/admin/utils/schemas.mjs
var import_omit = __toESM(require_omit(), 1);
var mutateCTBContentTypeSchema = (nextSchema, prevSchema) => {
  if (!prevSchema) {
    return nextSchema;
  }
  if (!doesPluginOptionsHaveI18nLocalized(nextSchema.pluginOptions)) {
    return nextSchema;
  }
  const isNextSchemaLocalized = nextSchema.pluginOptions.i18n.localized;
  const isPrevSchemaLocalized = doesPluginOptionsHaveI18nLocalized(prevSchema == null ? void 0 : prevSchema.pluginOptions) ? prevSchema == null ? void 0 : prevSchema.pluginOptions.i18n.localized : false;
  if (isNextSchemaLocalized && isPrevSchemaLocalized) {
    return nextSchema;
  }
  if (isNextSchemaLocalized) {
    const attributes = addLocalisationToFields(nextSchema.attributes);
    return {
      ...nextSchema,
      attributes
    };
  }
  if (!isNextSchemaLocalized) {
    const pluginOptions = (0, import_omit.default)(nextSchema.pluginOptions, "i18n");
    const attributes = disableAttributesLocalisation(nextSchema.attributes);
    return {
      ...nextSchema,
      pluginOptions,
      attributes
    };
  }
  return nextSchema;
};
var addLocalisationToFields = (attributes) => {
  return attributes.map((currentAttribute) => {
    if (LOCALIZED_FIELDS.includes(currentAttribute.type)) {
      const i18n = {
        localized: true
      };
      const pluginOptions = currentAttribute.pluginOptions ? {
        ...currentAttribute.pluginOptions,
        i18n
      } : {
        i18n
      };
      return {
        ...currentAttribute,
        pluginOptions
      };
    }
    return currentAttribute;
  });
};
var disableAttributesLocalisation = (attributes) => {
  return attributes.map((currentAttribute) => {
    return (0, import_omit.default)(currentAttribute, "pluginOptions.i18n");
  });
};

// node_modules/@strapi/i18n/dist/admin/index.mjs
function __variableDynamicImportRuntime1__2(path) {
  switch (path) {
    case "./translations/de.json":
      return import("./de.json-YTOGLXJI.js");
    case "./translations/dk.json":
      return import("./dk.json-72I6MEAZ.js");
    case "./translations/en.json":
      return import("./en.json-M6YDYHQC.js");
    case "./translations/es.json":
      return import("./es.json-NYTG6PJT.js");
    case "./translations/fr.json":
      return import("./fr.json-KOZ5KIZ5.js");
    case "./translations/ko.json":
      return import("./ko.json-7LNB7CNC.js");
    case "./translations/pl.json":
      return import("./pl.json-FYKDY6BQ.js");
    case "./translations/ru.json":
      return import("./ru.json-R3U5MBSO.js");
    case "./translations/tr.json":
      return import("./tr.json-HDJKSAL6.js");
    case "./translations/uk.json":
      return import("./uk.json-R5OQDKG4.js");
    case "./translations/zh-Hans.json":
      return import("./zh-Hans.json-JB5YZZP7.js");
    case "./translations/zh.json":
      return import("./zh.json-32A62ZT5.js");
    default:
      return new Promise(function(resolve, reject) {
        (typeof queueMicrotask === "function" ? queueMicrotask : setTimeout)(
          reject.bind(null, new Error("Unknown variable dynamic import: " + path))
        );
      });
  }
}
var index3 = {
  register(app) {
    app.addMiddlewares([
      extendCTBAttributeInitialDataMiddleware,
      extendCTBInitialDataMiddleware
    ]);
    app.addMiddlewares([
      () => i18nApi.middleware
    ]);
    app.addReducers({
      [i18nApi.reducerPath]: i18nApi.reducer
    });
    app.addRBACMiddleware([
      localeMiddleware
    ]);
    app.registerPlugin({
      id: pluginId,
      name: pluginId
    });
  },
  bootstrap(app) {
    app.registerHook("Admin/CM/pages/ListView/inject-column-in-table", addColumnToTableHook);
    app.registerHook("Admin/CM/pages/EditView/mutate-edit-view-layout", mutateEditViewHook);
    app.registerHook("ContentReleases/pages/ReleaseDetails/add-locale-in-releases", addLocaleToReleasesHook);
    app.addSettingsLink("global", {
      intlLabel: {
        id: getTranslation("plugin.name"),
        defaultMessage: "Internationalization"
      },
      id: "internationalization",
      to: "internationalization",
      Component: () => import("./SettingsPage-BHONDSLE.js").then((mod) => ({
        default: mod.ProtectedSettingsPage
      })),
      permissions: PERMISSIONS2.accessMain
    });
    const contentManager = app.getPlugin("content-manager");
    contentManager.apis.addDocumentHeaderAction([
      LocalePickerAction,
      FillFromAnotherLocaleAction
    ]);
    contentManager.apis.addDocumentAction((actions) => {
      const indexOfDeleteAction = actions.findIndex((action) => action.type === "delete");
      actions.splice(indexOfDeleteAction, 0, DeleteLocaleAction);
      return actions;
    });
    contentManager.apis.addDocumentAction((actions) => {
      actions.splice(2, 0, BulkLocalePublishAction);
      actions.splice(5, 0, BulkLocaleUnpublishAction);
      return actions;
    });
    contentManager.injectComponent("listView", "actions", {
      name: "i18n-locale-filter",
      Component: LocalePicker
    });
    contentManager.injectComponent("listView", "publishModalAdditionalInfos", {
      name: "i18n-publish-bullets-in-modal",
      Component: PublishModalAdditionalInfo
    });
    contentManager.injectComponent("listView", "unpublishModalAdditionalInfos", {
      name: "i18n-unpublish-bullets-in-modal",
      Component: UnpublishModalAdditionalInfo
    });
    contentManager.injectComponent("listView", "deleteModalAdditionalInfos", {
      name: "i18n-delete-bullets-in-modal",
      Component: DeleteModalAdditionalInfo
    });
    const ctbPlugin = app.getPlugin("content-type-builder");
    if (ctbPlugin) {
      const ctbFormsAPI = ctbPlugin.apis.forms;
      ctbFormsAPI.addContentTypeSchemaMutation(mutateCTBContentTypeSchema);
      ctbFormsAPI.components.add({
        id: "checkboxConfirmation",
        component: CheckboxConfirmation
      });
      ctbFormsAPI.extendContentType({
        validator: () => ({
          i18n: create3().shape({
            localized: create()
          })
        }),
        form: {
          advanced() {
            return [
              {
                name: "pluginOptions.i18n.localized",
                description: {
                  id: getTranslation("plugin.schema.i18n.localized.description-content-type"),
                  defaultMessage: "Allows translating an entry into different languages"
                },
                type: "checkboxConfirmation",
                intlLabel: {
                  id: getTranslation("plugin.schema.i18n.localized.label-content-type"),
                  defaultMessage: "Localization"
                }
              }
            ];
          }
        }
      });
      ctbFormsAPI.extendFields(LOCALIZED_FIELDS, {
        form: {
          advanced({ contentTypeSchema, forTarget, type, step }) {
            if (forTarget !== "contentType") {
              return [];
            }
            const hasI18nEnabled = (0, import_get2.default)(contentTypeSchema, [
              "pluginOptions",
              "i18n",
              "localized"
            ], false);
            if (!hasI18nEnabled) {
              return [];
            }
            if (type === "component" && step === "1") {
              return [];
            }
            return [
              {
                name: "pluginOptions.i18n.localized",
                description: {
                  id: getTranslation("plugin.schema.i18n.localized.description-field"),
                  defaultMessage: "The field can have different values in each locale"
                },
                type: "checkbox",
                intlLabel: {
                  id: getTranslation("plugin.schema.i18n.localized.label-field"),
                  defaultMessage: "Enable localization for this field"
                }
              }
            ];
          }
        }
      });
    }
  },
  async registerTrads({ locales }) {
    const importedTrads = await Promise.all(locales.map((locale) => {
      return __variableDynamicImportRuntime1__2(`./translations/${locale}.json`).then(({ default: data }) => {
        return {
          data: prefixPluginTranslations2(data, pluginId),
          locale
        };
      }).catch(() => {
        return {
          data: {},
          locale
        };
      });
    }));
    return Promise.resolve(importedTrads);
  }
};

// node_modules/@strapi/content-releases/dist/admin/components/ReleaseAction.mjs
var import_jsx_runtime10 = __toESM(require_jsx_runtime(), 1);
var import_react4 = __toESM(require_react(), 1);

// node_modules/@strapi/content-releases/dist/admin/components/ReleaseActionModal.mjs
var import_jsx_runtime9 = __toESM(require_jsx_runtime(), 1);
var import_react3 = __toESM(require_react(), 1);
var RELEASE_ACTION_FORM_SCHEMA = create3().shape({
  type: create2().oneOf([
    "publish",
    "unpublish"
  ]).required(),
  releaseId: create2().required()
});
var INITIAL_VALUES = {
  type: "publish",
  releaseId: ""
};
var NoReleases = () => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime9.jsx)(EmptyStateLayout, {
    icon: (0, import_jsx_runtime9.jsx)(ForwardRef$J, {
      width: "16rem"
    }),
    content: formatMessage({
      id: "content-releases.content-manager-edit-view.add-to-release.no-releases-message",
      defaultMessage: "No available releases. Open the list of releases and create a new one from there."
    }),
    action: (0, import_jsx_runtime9.jsx)(LinkButton, {
      to: {
        pathname: "/plugins/content-releases"
      },
      tag: Link,
      variant: "secondary",
      children: formatMessage({
        id: "content-releases.content-manager-edit-view.add-to-release.redirect-button",
        defaultMessage: "Open the list of releases"
      })
    }),
    shadow: "none"
  });
};
var AddActionToReleaseModal = ({ contentType, documentId, onInputChange, values }) => {
  var _a, _b, _c;
  const { formatMessage } = useIntl();
  const [{ query }] = useQueryParams();
  const locale = (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale;
  const response = useGetReleasesForEntryQuery({
    contentType,
    entryDocumentId: documentId,
    hasEntryAttached: false,
    locale
  });
  const releases = (_c = response.data) == null ? void 0 : _c.data;
  if ((releases == null ? void 0 : releases.length) === 0) {
    return (0, import_jsx_runtime9.jsx)(NoReleases, {});
  }
  return (0, import_jsx_runtime9.jsxs)(Flex, {
    direction: "column",
    alignItems: "stretch",
    gap: 2,
    children: [
      (0, import_jsx_runtime9.jsx)(Box, {
        paddingBottom: 6,
        children: (0, import_jsx_runtime9.jsxs)(Field.Root, {
          required: true,
          children: [
            (0, import_jsx_runtime9.jsx)(Field.Label, {
              children: formatMessage({
                id: "content-releases.content-manager-edit-view.add-to-release.select-label",
                defaultMessage: "Select a release"
              })
            }),
            (0, import_jsx_runtime9.jsx)(SingleSelect, {
              required: true,
              placeholder: formatMessage({
                id: "content-releases.content-manager-edit-view.add-to-release.select-placeholder",
                defaultMessage: "Select"
              }),
              name: "releaseId",
              onChange: (value) => onInputChange("releaseId", value),
              value: values.releaseId,
              children: releases == null ? void 0 : releases.map((release) => (0, import_jsx_runtime9.jsx)(SingleSelectOption, {
                value: release.id,
                children: release.name
              }, release.id))
            })
          ]
        })
      }),
      (0, import_jsx_runtime9.jsx)(Field.Label, {
        children: formatMessage({
          id: "content-releases.content-manager-edit-view.add-to-release.action-type-label",
          defaultMessage: "What do you want to do with this entry?"
        })
      }),
      (0, import_jsx_runtime9.jsx)(ReleaseActionOptions, {
        selected: values.type,
        handleChange: (e) => onInputChange("type", e.target.value),
        name: "type"
      })
    ]
  });
};
var ReleaseActionModalForm = ({ documentId, document, model, collectionType }) => {
  var _a, _b;
  const { formatMessage } = useIntl();
  const { allowedActions } = useRBAC(PERMISSIONS3);
  const { canCreateAction } = allowedActions;
  const [createReleaseAction, { isLoading }] = useCreateReleaseActionMutation();
  const { toggleNotification } = useNotification();
  const { formatAPIError } = useAPIErrorHandler();
  const [{ query }] = useQueryParams();
  const locale = (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale;
  const handleSubmit = async (e, onClose) => {
    try {
      await formik.handleSubmit(e);
      onClose();
    } catch (error) {
      if (isFetchError(error)) {
        toggleNotification({
          type: "danger",
          message: formatAPIError(error)
        });
      } else {
        toggleNotification({
          type: "danger",
          message: formatMessage({
            id: "notification.error",
            defaultMessage: "An error occurred"
          })
        });
      }
    }
  };
  const formik = useFormik({
    initialValues: INITIAL_VALUES,
    validationSchema: RELEASE_ACTION_FORM_SCHEMA,
    onSubmit: async (values) => {
      if (collectionType === "collection-types" && !documentId) {
        throw new Error("Document id is required");
      }
      const response = await createReleaseAction({
        body: {
          type: values.type,
          contentType: model,
          entryDocumentId: documentId,
          locale
        },
        params: {
          releaseId: values.releaseId
        }
      });
      if ("data" in response) {
        toggleNotification({
          type: "success",
          message: formatMessage({
            id: "content-releases.content-manager-edit-view.add-to-release.notification.success",
            defaultMessage: "Entry added to release"
          })
        });
        return;
      }
      if ("error" in response) {
        throw response.error;
      }
    }
  });
  const { edit: { options } } = useDocumentLayout(model);
  if (!window.strapi.isEE || !(options == null ? void 0 : options.draftAndPublish) || !canCreateAction) {
    return null;
  }
  if (collectionType === "collection-types" && (!documentId || documentId === "create")) {
    return null;
  }
  return {
    label: formatMessage({
      id: "content-releases.content-manager-edit-view.add-to-release",
      defaultMessage: "Add to release"
    }),
    icon: (0, import_jsx_runtime9.jsx)(ForwardRef$1F, {}),
    // Entry is creating so we don't want to allow adding it to a release
    disabled: !document,
    position: [
      "panel",
      "table-row"
    ],
    dialog: {
      type: "modal",
      title: formatMessage({
        id: "content-releases.content-manager-edit-view.add-to-release",
        defaultMessage: "Add to release"
      }),
      content: (0, import_jsx_runtime9.jsx)(AddActionToReleaseModal, {
        contentType: model,
        documentId,
        onInputChange: formik.setFieldValue,
        values: formik.values
      }),
      footer: ({ onClose }) => (0, import_jsx_runtime9.jsxs)(Modal.Footer, {
        children: [
          (0, import_jsx_runtime9.jsx)(Button, {
            onClick: onClose,
            variant: "tertiary",
            name: "cancel",
            children: formatMessage({
              id: "content-releases.content-manager-edit-view.add-to-release.cancel-button",
              defaultMessage: "Cancel"
            })
          }),
          (0, import_jsx_runtime9.jsx)(Button, {
            type: "submit",
            // @ts-expect-error - formik ReactEvent types don't match button onClick types as they expect a MouseEvent
            onClick: (e) => handleSubmit(e, onClose),
            disabled: !formik.values.releaseId,
            loading: isLoading,
            children: formatMessage({
              id: "content-releases.content-manager-edit-view.add-to-release.continue-button",
              defaultMessage: "Continue"
            })
          })
        ]
      })
    }
  };
};

// node_modules/@strapi/content-releases/dist/admin/components/ReleaseAction.mjs
var getContentPermissions = (subject) => {
  const permissions = {
    publish: [
      {
        action: "plugin::content-manager.explorer.publish",
        subject,
        id: "",
        actionParameters: {},
        properties: {},
        conditions: []
      }
    ]
  };
  return permissions;
};
var ReleaseAction = ({ documents, model }) => {
  var _a;
  const { formatMessage } = useIntl();
  const { toggleNotification } = useNotification();
  const { formatAPIError } = useAPIErrorHandler();
  const [{ query }] = useQueryParams();
  const contentPermissions = getContentPermissions(model);
  const { allowedActions: { canPublish } } = useRBAC(contentPermissions);
  const { allowedActions: { canCreate } } = useRBAC(PERMISSIONS3);
  const { hasDraftAndPublish } = useContentManagerContext();
  const response = useGetReleasesQuery();
  const releases = (_a = response.data) == null ? void 0 : _a.data;
  const [createManyReleaseActions, { isLoading }] = useCreateManyReleaseActionsMutation();
  const documentIds = documents.map((doc) => doc.documentId);
  const handleSubmit = async (values) => {
    var _a2, _b;
    const locale = (_b = (_a2 = query.plugins) == null ? void 0 : _a2.i18n) == null ? void 0 : _b.locale;
    const releaseActionEntries = documentIds.map((entryDocumentId) => ({
      type: values.type,
      contentType: model,
      entryDocumentId,
      locale
    }));
    const response2 = await createManyReleaseActions({
      body: releaseActionEntries,
      params: {
        releaseId: values.releaseId
      }
    });
    if ("data" in response2) {
      const notificationMessage = formatMessage({
        id: "content-releases.content-manager-list-view.add-to-release.notification.success.message",
        defaultMessage: "{entriesAlreadyInRelease} out of {totalEntries} entries were already in the release."
      }, {
        entriesAlreadyInRelease: response2.data.meta.entriesAlreadyInRelease,
        totalEntries: response2.data.meta.totalEntries
      });
      const notification = {
        type: "success",
        title: formatMessage({
          id: "content-releases.content-manager-list-view.add-to-release.notification.success.title",
          defaultMessage: "Successfully added to release."
        }, {
          entriesAlreadyInRelease: response2.data.meta.entriesAlreadyInRelease,
          totalEntries: response2.data.meta.totalEntries
        }),
        message: response2.data.meta.entriesAlreadyInRelease ? notificationMessage : ""
      };
      toggleNotification(notification);
      return true;
    }
    if ("error" in response2) {
      if (isFetchError(response2.error)) {
        toggleNotification({
          type: "warning",
          message: formatAPIError(response2.error)
        });
      } else {
        toggleNotification({
          type: "warning",
          message: formatMessage({
            id: "notification.error",
            defaultMessage: "An error occurred"
          })
        });
      }
    }
  };
  if (!hasDraftAndPublish || !canCreate || !canPublish) return null;
  return {
    actionType: "release",
    variant: "tertiary",
    label: formatMessage({
      id: "content-manager-list-view.add-to-release",
      defaultMessage: "Add to Release"
    }),
    dialog: {
      type: "modal",
      title: formatMessage({
        id: "content-manager-list-view.add-to-release",
        defaultMessage: "Add to Release"
      }),
      content: ({ onClose }) => {
        return (0, import_jsx_runtime10.jsx)(Formik, {
          onSubmit: async (values) => {
            const data = await handleSubmit(values);
            if (data) {
              return onClose();
            }
          },
          validationSchema: RELEASE_ACTION_FORM_SCHEMA,
          initialValues: INITIAL_VALUES,
          children: ({ values, setFieldValue }) => (0, import_jsx_runtime10.jsxs)(Form, {
            children: [
              (releases == null ? void 0 : releases.length) === 0 ? (0, import_jsx_runtime10.jsx)(NoReleases, {}) : (0, import_jsx_runtime10.jsx)(Modal.Body, {
                children: (0, import_jsx_runtime10.jsxs)(Flex, {
                  direction: "column",
                  alignItems: "stretch",
                  gap: 2,
                  children: [
                    (0, import_jsx_runtime10.jsx)(Box, {
                      paddingBottom: 6,
                      children: (0, import_jsx_runtime10.jsxs)(Field.Root, {
                        required: true,
                        children: [
                          (0, import_jsx_runtime10.jsx)(Field.Label, {
                            children: formatMessage({
                              id: "content-releases.content-manager-list-view.add-to-release.select-label",
                              defaultMessage: "Select a release"
                            })
                          }),
                          (0, import_jsx_runtime10.jsx)(SingleSelect, {
                            placeholder: formatMessage({
                              id: "content-releases.content-manager-list-view.add-to-release.select-placeholder",
                              defaultMessage: "Select"
                            }),
                            onChange: (value) => setFieldValue("releaseId", value),
                            value: values.releaseId,
                            children: releases == null ? void 0 : releases.map((release) => (0, import_jsx_runtime10.jsx)(SingleSelectOption, {
                              value: release.id,
                              children: release.name
                            }, release.id))
                          })
                        ]
                      })
                    }),
                    (0, import_jsx_runtime10.jsx)(Field.Label, {
                      children: formatMessage({
                        id: "content-releases.content-manager-list-view.add-to-release.action-type-label",
                        defaultMessage: "What do you want to do with these entries?"
                      })
                    }),
                    (0, import_jsx_runtime10.jsx)(ReleaseActionOptions, {
                      selected: values.type,
                      handleChange: (e) => setFieldValue("type", e.target.value),
                      name: "type"
                    })
                  ]
                })
              }),
              (0, import_jsx_runtime10.jsxs)(Modal.Footer, {
                children: [
                  (0, import_jsx_runtime10.jsx)(Button, {
                    onClick: onClose,
                    variant: "tertiary",
                    name: "cancel",
                    children: formatMessage({
                      id: "content-releases.content-manager-list-view.add-to-release.cancel-button",
                      defaultMessage: "Cancel"
                    })
                  }),
                  (0, import_jsx_runtime10.jsx)(Button, {
                    type: "submit",
                    disabled: !values.releaseId,
                    loading: isLoading,
                    children: formatMessage({
                      id: "content-releases.content-manager-list-view.add-to-release.continue-button",
                      defaultMessage: "Continue"
                    })
                  })
                ]
              })
            ]
          })
        });
      }
    }
  };
};

// node_modules/@strapi/content-releases/dist/admin/components/ReleaseListCell.mjs
var import_jsx_runtime11 = __toESM(require_jsx_runtime(), 1);
var import_react5 = __toESM(require_react(), 1);
var useReleasesList = (contentTypeUid, documentId) => {
  var _a, _b;
  const listViewData = useTable("ListView", (state) => state.rows);
  const documentIds = listViewData.map((entry) => entry.documentId);
  const [{ query }] = useQueryParams();
  const locale = ((_b = (_a = query == null ? void 0 : query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale) || void 0;
  const response = useGetMappedEntriesInReleasesQuery({
    contentTypeUid,
    documentIds,
    locale
  }, {
    skip: !documentIds || !contentTypeUid || documentIds.length === 0
  });
  const mappedEntriesInReleases = response.data || {};
  return (mappedEntriesInReleases == null ? void 0 : mappedEntriesInReleases[documentId]) || [];
};
var addColumnToTableHook2 = ({ displayedHeaders, layout }) => {
  const { options } = layout;
  if (!(options == null ? void 0 : options.draftAndPublish)) {
    return {
      displayedHeaders,
      layout
    };
  }
  return {
    displayedHeaders: [
      ...displayedHeaders,
      {
        searchable: false,
        sortable: false,
        name: "releases",
        label: {
          id: "content-releases.content-manager.list-view.releases.header",
          defaultMessage: "To be released in"
        },
        cellFormatter: (props, _, { model }) => (0, import_jsx_runtime11.jsx)(ReleaseListCell, {
          ...props,
          model
        })
      }
    ],
    layout
  };
};
var ReleaseListCell = ({ documentId, model }) => {
  const releases = useReleasesList(model, documentId);
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime11.jsxs)(Popover.Root, {
    children: [
      (0, import_jsx_runtime11.jsx)(Popover.Trigger, {
        children: (0, import_jsx_runtime11.jsx)(Button, {
          variant: "ghost",
          onClick: (e) => e.stopPropagation(),
          // TODO: find a way in the DS to define the widht and height of the icon
          endIcon: releases.length > 0 ? (0, import_jsx_runtime11.jsx)(ForwardRef$4$, {
            width: "1.2rem",
            height: "1.2rem"
          }) : null,
          children: (0, import_jsx_runtime11.jsx)(Typography, {
            style: {
              maxWidth: "252px",
              cursor: "pointer"
            },
            textColor: "neutral800",
            fontWeight: "regular",
            children: releases.length > 0 ? formatMessage({
              id: "content-releases.content-manager.list-view.releases-number",
              defaultMessage: "{number} {number, plural, one {release} other {releases}}"
            }, {
              number: releases.length
            }) : "-"
          })
        })
      }),
      (0, import_jsx_runtime11.jsx)(Popover.Content, {
        children: (0, import_jsx_runtime11.jsx)("ul", {
          children: releases.map(({ id, name }) => (0, import_jsx_runtime11.jsx)(Box, {
            padding: 3,
            tag: "li",
            children: (0, import_jsx_runtime11.jsx)(Link2, {
              href: `/admin/plugins/content-releases/${id}`,
              isExternal: false,
              children: name
            })
          }, id))
        })
      })
    ]
  });
};

// node_modules/@strapi/content-releases/dist/admin/components/ReleasesPanel.mjs
var import_jsx_runtime12 = __toESM(require_jsx_runtime(), 1);
var Panel = ({ model, document, documentId, collectionType }) => {
  var _a, _b, _c;
  const [{ query }] = useQueryParams();
  const locale = (_b = (_a = query.plugins) == null ? void 0 : _a.i18n) == null ? void 0 : _b.locale;
  const { edit: { options } } = useDocumentLayout(model);
  const { formatMessage, formatDate, formatTime } = useIntl();
  const { allowedActions } = useRBAC(PERMISSIONS3);
  const { canRead, canDeleteAction } = allowedActions;
  const response = useGetReleasesForEntryQuery({
    contentType: model,
    entryDocumentId: documentId,
    locale,
    hasEntryAttached: true
  }, {
    skip: !document
  });
  const releases = (_c = response.data) == null ? void 0 : _c.data;
  const getReleaseColorVariant = (actionType, shade) => {
    if (actionType === "unpublish") {
      return `secondary${shade}`;
    }
    return `success${shade}`;
  };
  if (!window.strapi.isEE || !(options == null ? void 0 : options.draftAndPublish) || !canRead) {
    return null;
  }
  if (collectionType === "collection-types" && (!documentId || documentId === "create")) {
    return null;
  }
  if (!releases || releases.length === 0) {
    return null;
  }
  return {
    title: formatMessage({
      id: "content-releases.plugin.name",
      defaultMessage: "Releases"
    }),
    content: (0, import_jsx_runtime12.jsx)(Flex, {
      direction: "column",
      alignItems: "stretch",
      gap: 3,
      width: "100%",
      children: releases == null ? void 0 : releases.map((release) => (0, import_jsx_runtime12.jsxs)(Flex, {
        direction: "column",
        alignItems: "start",
        borderWidth: "1px",
        borderStyle: "solid",
        borderColor: getReleaseColorVariant(release.actions[0].type, "200"),
        overflow: "hidden",
        hasRadius: true,
        children: [
          (0, import_jsx_runtime12.jsx)(Box, {
            paddingTop: 3,
            paddingBottom: 3,
            paddingLeft: 4,
            paddingRight: 4,
            background: getReleaseColorVariant(release.actions[0].type, "100"),
            width: "100%",
            children: (0, import_jsx_runtime12.jsx)(Typography, {
              fontSize: 1,
              variant: "pi",
              textColor: getReleaseColorVariant(release.actions[0].type, "600"),
              children: formatMessage({
                id: "content-releases.content-manager-edit-view.list-releases.title",
                defaultMessage: "{isPublish, select, true {Will be published in} other {Will be unpublished in}}"
              }, {
                isPublish: release.actions[0].type === "publish"
              })
            })
          }),
          (0, import_jsx_runtime12.jsxs)(Flex, {
            padding: 4,
            direction: "column",
            gap: 2,
            width: "100%",
            alignItems: "flex-start",
            children: [
              (0, import_jsx_runtime12.jsx)(Typography, {
                fontSize: 2,
                fontWeight: "bold",
                variant: "omega",
                textColor: "neutral700",
                children: release.name
              }),
              release.scheduledAt && release.timezone && (0, import_jsx_runtime12.jsx)(Typography, {
                variant: "pi",
                textColor: "neutral600",
                children: formatMessage({
                  id: "content-releases.content-manager-edit-view.scheduled.date",
                  defaultMessage: "{date} at {time} ({offset})"
                }, {
                  date: formatDate(new Date(release.scheduledAt), {
                    day: "2-digit",
                    month: "2-digit",
                    year: "numeric",
                    timeZone: release.timezone
                  }),
                  time: formatTime(new Date(release.scheduledAt), {
                    hourCycle: "h23",
                    timeZone: release.timezone
                  }),
                  offset: getTimezoneOffset(release.timezone, new Date(release.scheduledAt))
                })
              }),
              canDeleteAction ? (0, import_jsx_runtime12.jsxs)(ReleaseActionMenu.Root, {
                hasTriggerBorder: true,
                children: [
                  (0, import_jsx_runtime12.jsx)(ReleaseActionMenu.EditReleaseItem, {
                    releaseId: release.id
                  }),
                  (0, import_jsx_runtime12.jsx)(ReleaseActionMenu.DeleteReleaseActionItem, {
                    releaseId: release.id,
                    actionId: release.actions[0].id
                  })
                ]
              }) : null
            ]
          })
        ]
      }, release.id))
    })
  };
};

// node_modules/@strapi/content-releases/dist/admin/utils/prefixPluginTranslations.mjs
var prefixPluginTranslations3 = (trad, pluginId3) => {
  return Object.keys(trad).reduce((acc, current) => {
    acc[`${pluginId3}.${current}`] = trad[current];
    return acc;
  }, {});
};

// node_modules/@strapi/content-releases/dist/admin/index.mjs
function __variableDynamicImportRuntime4__(path) {
  switch (path) {
    case "./translations/en.json":
      return import("./en.json-B5CCX7OL.js");
    case "./translations/uk.json":
      return import("./uk.json-R7E67MQ6.js");
    default:
      return new Promise(function(resolve, reject) {
        (typeof queueMicrotask === "function" ? queueMicrotask : setTimeout)(
          reject.bind(null, new Error("Unknown variable dynamic import: " + path))
        );
      });
  }
}
var admin3 = {
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  register(app) {
    var _a, _b;
    app.createHook("ContentReleases/pages/ReleaseDetails/add-locale-in-releases");
    if (window.strapi.features.isEnabled("cms-content-releases")) {
      app.addMenuLink({
        to: `plugins/${pluginId2}`,
        icon: ForwardRef$1F,
        intlLabel: {
          id: `${pluginId2}.plugin.name`,
          defaultMessage: "Releases"
        },
        Component: () => import("./App-KHER6LRI.js").then((mod) => ({
          default: mod.App
        })),
        permissions: PERMISSIONS3.main,
        position: 2
      });
      const contentManagerPluginApis = app.getPlugin("content-manager").apis;
      if ("addEditViewSidePanel" in contentManagerPluginApis && typeof contentManagerPluginApis.addEditViewSidePanel === "function") {
        contentManagerPluginApis.addEditViewSidePanel([
          Panel
        ]);
      }
      if ("addDocumentAction" in contentManagerPluginApis && typeof contentManagerPluginApis.addDocumentAction === "function") {
        contentManagerPluginApis.addDocumentAction((actions) => {
          const indexOfDeleteAction = actions.findIndex((action) => action.type === "unpublish");
          actions.splice(indexOfDeleteAction, 0, ReleaseActionModalForm);
          return actions;
        });
      }
      app.addSettingsLink("global", {
        id: pluginId2,
        to: "releases",
        intlLabel: {
          id: `${pluginId2}.plugin.name`,
          defaultMessage: "Releases"
        },
        licenseOnly: true,
        permissions: [],
        async Component() {
          const { ProtectedReleasesSettingsPage } = await import("./ReleasesSettingsPage-NDXVFWTV.js");
          return {
            default: ProtectedReleasesSettingsPage
          };
        }
      });
      if ("addBulkAction" in contentManagerPluginApis && typeof contentManagerPluginApis.addBulkAction === "function") {
        contentManagerPluginApis.addBulkAction((actions) => {
          const deleteActionIndex = actions.findIndex((action) => action.type === "delete");
          actions.splice(deleteActionIndex, 0, ReleaseAction);
          return actions;
        });
      }
      app.registerHook("Admin/CM/pages/ListView/inject-column-in-table", addColumnToTableHook2);
      app.widgets.register([
        {
          icon: ForwardRef$1F,
          title: {
            id: `${PLUGIN_ID}.widget.upcoming-releases.title`,
            defaultMessage: "Upcoming releases"
          },
          component: async () => {
            const { UpcomingReleasesWidget } = await import("./Widgets-HKKT37PJ.js");
            return UpcomingReleasesWidget;
          },
          pluginId: PLUGIN_ID,
          id: "upcoming-releases",
          link: {
            label: {
              id: `${PLUGIN_ID}.widget.upcoming-releases.link`,
              defaultMessage: "Open Releases"
            },
            href: "/plugins/content-releases"
          }
        }
      ]);
    } else if (!window.strapi.features.isEnabled("cms-content-releases") && ((_b = (_a = window.strapi) == null ? void 0 : _a.flags) == null ? void 0 : _b.promoteEE)) {
      app.addSettingsLink("global", {
        id: pluginId2,
        to: "/plugins/purchase-content-releases",
        intlLabel: {
          id: `${pluginId2}.plugin.name`,
          defaultMessage: "Releases"
        },
        permissions: [],
        async Component() {
          const { PurchaseContentReleases } = await import("./PurchaseContentReleases-F3A7SWFR.js");
          return {
            default: PurchaseContentReleases
          };
        },
        licenseOnly: true
      });
    }
  },
  async registerTrads({ locales }) {
    const importedTrads = await Promise.all(locales.map((locale) => {
      return __variableDynamicImportRuntime4__(`./translations/${locale}.json`).then(({ default: data }) => {
        return {
          data: prefixPluginTranslations3(data, "content-releases"),
          locale
        };
      }).catch(() => {
        return {
          data: {},
          locale
        };
      });
    }));
    return Promise.resolve(importedTrads);
  }
};

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/Header.mjs
var import_jsx_runtime15 = __toESM(require_jsx_runtime(), 1);

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/AssigneeSelect.mjs
var import_jsx_runtime13 = __toESM(require_jsx_runtime(), 1);
var React6 = __toESM(require_react(), 1);

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/constants.mjs
var STAGE_ATTRIBUTE_NAME = "strapi_stage";
var ASSIGNEE_ATTRIBUTE_NAME = "strapi_assignee";

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/AssigneeSelect.mjs
var AssigneeSelect = ({ isCompact }) => {
  var _a;
  const { collectionType = "", id, slug: model = "" } = useParams();
  const permissions = useTypedSelector((state) => state.admin_app.permissions);
  const { formatMessage } = useIntl();
  const { _unstableFormatAPIError: formatAPIError } = useAPIErrorHandler();
  const { toggleNotification } = useNotification();
  const { allowedActions: { canRead }, isLoading: isLoadingPermissions } = useRBAC((_a = permissions.settings) == null ? void 0 : _a.users);
  const [{ query }] = useQueryParams();
  const params = React6.useMemo(() => buildValidParams2(query), [
    query
  ]);
  const { data, isLoading: isLoadingUsers, isError } = useAdminUsers(void 0, {
    skip: isLoadingPermissions || !canRead
  });
  const { document } = useDocument({
    collectionType,
    model,
    documentId: id
  }, {
    skip: !id && collectionType !== "single-types"
  });
  const users = (data == null ? void 0 : data.users) || [];
  const currentAssignee = document ? document[ASSIGNEE_ATTRIBUTE_NAME] : null;
  const [updateAssignee, { error, isLoading: isMutating }] = useUpdateAssigneeMutation();
  if (!collectionType || !model || !(document == null ? void 0 : document.documentId)) {
    return null;
  }
  const handleChange = async (assigneeId) => {
    if ((currentAssignee == null ? void 0 : currentAssignee.id) === assigneeId) {
      return;
    }
    const res = await updateAssignee({
      slug: collectionType,
      model,
      id: document.documentId,
      params,
      data: {
        id: assigneeId ? parseInt(assigneeId, 10) : null
      }
    });
    if ("data" in res) {
      toggleNotification({
        type: "success",
        message: formatMessage({
          id: "content-manager.reviewWorkflows.assignee.notification.saved",
          defaultMessage: "Assignee updated"
        })
      });
    }
    if (isCompact && "error" in res) {
      toggleNotification({
        type: "danger",
        message: formatAPIError(res.error)
      });
    }
  };
  const isDisabled = !isLoadingPermissions && !isLoadingUsers && users.length === 0 || !document.documentId;
  const isLoading = isLoadingUsers || isLoadingPermissions || isMutating;
  const assigneeLabel = formatMessage({
    id: "content-manager.reviewWorkflows.assignee.label",
    defaultMessage: "Assignee"
  });
  const assigneeClearLabel = formatMessage({
    id: "content-manager.reviewWorkflows.assignee.clear",
    defaultMessage: "Clear assignee"
  });
  const assigneePlaceholder = formatMessage({
    id: "content-manager.reviewWorkflows.assignee.placeholder",
    defaultMessage: "Selectâ€¦"
  });
  if (isCompact) {
    return (0, import_jsx_runtime13.jsxs)(Field.Root, {
      name: ASSIGNEE_ATTRIBUTE_NAME,
      id: ASSIGNEE_ATTRIBUTE_NAME,
      children: [
        (0, import_jsx_runtime13.jsx)(VisuallyHidden, {
          children: (0, import_jsx_runtime13.jsx)(Field.Label, {
            children: assigneeLabel
          })
        }),
        (0, import_jsx_runtime13.jsx)(Combobox, {
          clearLabel: assigneeClearLabel,
          disabled: isDisabled,
          value: currentAssignee ? currentAssignee.id.toString() : null,
          onChange: handleChange,
          onClear: () => handleChange(null),
          placeholder: assigneePlaceholder,
          loading: isLoading || isLoadingPermissions || isMutating,
          size: "S",
          children: users.map((user) => {
            return (0, import_jsx_runtime13.jsx)(Option, {
              value: user.id.toString(),
              textValue: getDisplayName(user),
              children: getDisplayName(user)
            }, user.id);
          })
        })
      ]
    });
  }
  return (0, import_jsx_runtime13.jsxs)(Field.Root, {
    name: ASSIGNEE_ATTRIBUTE_NAME,
    id: ASSIGNEE_ATTRIBUTE_NAME,
    error: (isError && canRead && formatMessage({
      id: "content-manager.reviewWorkflows.assignee.error",
      defaultMessage: "An error occurred while fetching users"
    }) || error && formatAPIError(error)) ?? void 0,
    children: [
      (0, import_jsx_runtime13.jsx)(Field.Label, {
        children: assigneeLabel
      }),
      (0, import_jsx_runtime13.jsx)(Combobox, {
        clearLabel: assigneeClearLabel,
        disabled: !isLoadingPermissions && !isLoading && users.length === 0 || !document.documentId,
        value: currentAssignee ? currentAssignee.id.toString() : null,
        onChange: handleChange,
        onClear: () => handleChange(null),
        placeholder: assigneePlaceholder,
        loading: isLoading || isLoadingPermissions || isMutating,
        children: users.map((user) => {
          return (0, import_jsx_runtime13.jsx)(Option, {
            value: user.id.toString(),
            textValue: getDisplayName(user),
            children: getDisplayName(user)
          }, user.id);
        })
      }),
      (0, import_jsx_runtime13.jsx)(Field.Error, {})
    ]
  });
};

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/StageSelect.mjs
var import_jsx_runtime14 = __toESM(require_jsx_runtime(), 1);
var React7 = __toESM(require_react(), 1);
var WorkflowLimitModal = ({ open, onOpenChange }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime14.jsxs)(LimitsModal.Root, {
    open,
    onOpenChange,
    children: [
      (0, import_jsx_runtime14.jsx)(LimitsModal.Title, {
        children: formatMessage({
          id: "content-manager.reviewWorkflows.workflows.limit.title",
          defaultMessage: "Youâ€™ve reached the limit of workflows in your plan"
        })
      }),
      (0, import_jsx_runtime14.jsx)(LimitsModal.Body, {
        children: formatMessage({
          id: "content-manager.reviewWorkflows.workflows.limit.body",
          defaultMessage: "Delete a workflow or contact Sales to enable more workflows."
        })
      })
    ]
  });
};
var StageLimitModal = ({ open, onOpenChange }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime14.jsxs)(LimitsModal.Root, {
    open,
    onOpenChange,
    children: [
      (0, import_jsx_runtime14.jsx)(LimitsModal.Title, {
        children: formatMessage({
          id: "content-manager.reviewWorkflows.stages.limit.title",
          defaultMessage: "You have reached the limit of stages for this workflow in your plan"
        })
      }),
      (0, import_jsx_runtime14.jsx)(LimitsModal.Body, {
        children: formatMessage({
          id: "content-manager.reviewWorkflows.stages.limit.body",
          defaultMessage: "Try deleting some stages or contact Sales to enable more stages."
        })
      })
    ]
  });
};
var Select = ({ stages, activeWorkflowStage, isLoading, ...props }) => {
  const { formatMessage } = useIntl();
  const { themeColorName } = getStageColorByHex(activeWorkflowStage == null ? void 0 : activeWorkflowStage.color) ?? {};
  return (0, import_jsx_runtime14.jsx)(SingleSelect, {
    disabled: stages.length === 0,
    placeholder: formatMessage({
      id: "content-manager.reviewWorkflows.assignee.placeholder",
      defaultMessage: "Selectâ€¦"
    }),
    startIcon: activeWorkflowStage && (0, import_jsx_runtime14.jsx)(Flex, {
      tag: "span",
      height: 2,
      background: activeWorkflowStage == null ? void 0 : activeWorkflowStage.color,
      borderColor: themeColorName === "neutral0" ? "neutral150" : void 0,
      hasRadius: true,
      shrink: 0,
      width: 2,
      marginRight: "-3px"
    }),
    // @ts-expect-error â€“ `customizeContent` is not correctly typed in the DS.
    customizeContent: () => {
      return (0, import_jsx_runtime14.jsxs)(Flex, {
        tag: "span",
        justifyContent: "space-between",
        alignItems: "center",
        width: "100%",
        children: [
          (0, import_jsx_runtime14.jsx)(Typography, {
            textColor: "neutral800",
            ellipsis: true,
            lineHeight: "inherit",
            children: (activeWorkflowStage == null ? void 0 : activeWorkflowStage.name) ?? ""
          }),
          isLoading ? (0, import_jsx_runtime14.jsx)(Loader, {
            small: true,
            style: {
              display: "flex"
            },
            "data-testid": "loader"
          }) : null
        ]
      });
    },
    ...props,
    children: stages.map(({ id, color, name }) => {
      const { themeColorName: themeColorName2 } = getStageColorByHex(color) ?? {};
      return (0, import_jsx_runtime14.jsx)(SingleSelectOption, {
        startIcon: (0, import_jsx_runtime14.jsx)(Flex, {
          height: 2,
          background: color,
          borderColor: themeColorName2 === "neutral0" ? "neutral150" : void 0,
          hasRadius: true,
          shrink: 0,
          width: 2
        }),
        value: id,
        textValue: name,
        children: name
      }, id);
    })
  });
};
var StageSelect = ({ isCompact }) => {
  const { collectionType = "", slug: model = "", id = "" } = useParams();
  const { formatMessage } = useIntl();
  const { _unstableFormatAPIError: formatAPIError } = useAPIErrorHandler();
  const { toggleNotification } = useNotification();
  const [{ query }] = useQueryParams();
  const params = React7.useMemo(() => buildValidParams2(query), [
    query
  ]);
  const { document, isLoading: isLoadingDocument } = useDocument({
    collectionType,
    model,
    documentId: id
  }, {
    skip: !id && collectionType !== "single-types"
  });
  const { data, isLoading: isLoadingStages } = useGetStagesQuery({
    slug: collectionType,
    model,
    // @ts-expect-error â€“ `id` is not correctly typed in the DS.
    id: document == null ? void 0 : document.documentId,
    params
  }, {
    skip: !(document == null ? void 0 : document.documentId)
  });
  const { meta, stages = [] } = data ?? {};
  const { getFeature } = useLicenseLimits();
  const [showLimitModal, setShowLimitModal] = React7.useState(null);
  const limits = getFeature("review-workflows") ?? {};
  const activeWorkflowStage = document ? document[STAGE_ATTRIBUTE_NAME] : null;
  const [updateStage, { error }] = useUpdateStageMutation();
  const handleChange = async (stageId) => {
    try {
      if ((limits == null ? void 0 : limits[CHARGEBEE_WORKFLOW_ENTITLEMENT_NAME]) && parseInt(limits[CHARGEBEE_WORKFLOW_ENTITLEMENT_NAME], 10) < ((meta == null ? void 0 : meta.workflowCount) ?? 0)) {
        setShowLimitModal("workflow");
      } else if ((limits == null ? void 0 : limits[CHARGEBEE_STAGES_PER_WORKFLOW_ENTITLEMENT_NAME]) && parseInt(limits[CHARGEBEE_STAGES_PER_WORKFLOW_ENTITLEMENT_NAME], 10) < stages.length) {
        setShowLimitModal("stage");
      } else {
        if (document == null ? void 0 : document.documentId) {
          const res = await updateStage({
            model,
            id: document.documentId,
            slug: collectionType,
            params,
            data: {
              id: stageId
            }
          });
          if ("data" in res) {
            toggleNotification({
              type: "success",
              message: formatMessage({
                id: "content-manager.reviewWorkflows.stage.notification.saved",
                defaultMessage: "Review stage updated"
              })
            });
          }
          if (isCompact && "error" in res) {
            toggleNotification({
              type: "danger",
              message: formatAPIError(res.error)
            });
          }
        }
      }
    } catch (error2) {
      toggleNotification({
        type: "danger",
        message: formatMessage({
          id: "content-manager.reviewWorkflows.stage.notification.error",
          defaultMessage: "An error occurred while updating the review stage"
        })
      });
    }
  };
  const isLoading = isLoadingStages || isLoadingDocument;
  const reviewStageLabel = formatMessage({
    id: "content-manager.reviewWorkflows.stage.label",
    defaultMessage: "Review stage"
  });
  const reviewStageHint = !isLoading && stages.length === 0 && // TODO: Handle errors and hints
  formatMessage({
    id: "content-manager.reviewWorkflows.stages.no-transition",
    defaultMessage: "You donâ€™t have the permission to update this stage."
  });
  if (isCompact) {
    return (0, import_jsx_runtime14.jsxs)(import_jsx_runtime14.Fragment, {
      children: [
        (0, import_jsx_runtime14.jsx)(TooltipImpl, {
          label: reviewStageHint,
          children: (0, import_jsx_runtime14.jsx)(Field.Root, {
            name: STAGE_ATTRIBUTE_NAME,
            id: STAGE_ATTRIBUTE_NAME,
            children: (0, import_jsx_runtime14.jsxs)(import_jsx_runtime14.Fragment, {
              children: [
                (0, import_jsx_runtime14.jsx)(VisuallyHidden, {
                  children: (0, import_jsx_runtime14.jsx)(Field.Label, {
                    children: reviewStageLabel
                  })
                }),
                (0, import_jsx_runtime14.jsx)(Select, {
                  stages,
                  activeWorkflowStage,
                  isLoading,
                  size: "S",
                  disabled: stages.length === 0,
                  value: activeWorkflowStage == null ? void 0 : activeWorkflowStage.id,
                  onChange: handleChange,
                  placeholder: formatMessage({
                    id: "content-manager.reviewWorkflows.assignee.placeholder",
                    defaultMessage: "Selectâ€¦"
                  })
                })
              ]
            })
          })
        }),
        (0, import_jsx_runtime14.jsx)(WorkflowLimitModal, {
          open: showLimitModal === "workflow",
          onOpenChange: () => setShowLimitModal(null)
        }),
        (0, import_jsx_runtime14.jsx)(StageLimitModal, {
          open: showLimitModal === "stage",
          onOpenChange: () => setShowLimitModal(null)
        })
      ]
    });
  }
  return (0, import_jsx_runtime14.jsxs)(import_jsx_runtime14.Fragment, {
    children: [
      (0, import_jsx_runtime14.jsxs)(Field.Root, {
        hint: reviewStageHint,
        error: error && formatAPIError(error) || void 0,
        name: STAGE_ATTRIBUTE_NAME,
        id: STAGE_ATTRIBUTE_NAME,
        children: [
          (0, import_jsx_runtime14.jsx)(Field.Label, {
            children: reviewStageLabel
          }),
          (0, import_jsx_runtime14.jsx)(Select, {
            stages,
            activeWorkflowStage,
            isLoading,
            disabled: stages.length === 0,
            value: activeWorkflowStage == null ? void 0 : activeWorkflowStage.id,
            onChange: handleChange,
            placeholder: formatMessage({
              id: "content-manager.reviewWorkflows.assignee.placeholder",
              defaultMessage: "Selectâ€¦"
            })
          }),
          (0, import_jsx_runtime14.jsx)(Field.Hint, {}),
          (0, import_jsx_runtime14.jsx)(Field.Error, {})
        ]
      }),
      (0, import_jsx_runtime14.jsx)(WorkflowLimitModal, {
        open: showLimitModal === "workflow",
        onOpenChange: () => setShowLimitModal(null)
      }),
      (0, import_jsx_runtime14.jsx)(StageLimitModal, {
        open: showLimitModal === "stage",
        onOpenChange: () => setShowLimitModal(null)
      })
    ]
  });
};

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/Header.mjs
var Header = () => {
  const { slug = "", id, collectionType } = useParams();
  const { edit: { options } } = useDocumentLayout(slug);
  if (!window.strapi.isEE || !(options == null ? void 0 : options.reviewWorkflows) || collectionType !== "single-types" && !id || id === "create") {
    return null;
  }
  return (0, import_jsx_runtime15.jsxs)(Flex, {
    gap: 2,
    children: [
      (0, import_jsx_runtime15.jsx)(AssigneeSelect, {
        isCompact: true
      }),
      (0, import_jsx_runtime15.jsx)(StageSelect, {
        isCompact: true
      })
    ]
  });
};
Header.type = "preview";

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/id/components/Panel.mjs
var import_jsx_runtime16 = __toESM(require_jsx_runtime(), 1);
var Panel2 = () => {
  const { slug = "", id, collectionType } = useParams();
  const { edit: { options } } = useDocumentLayout(slug);
  const { formatMessage } = useIntl();
  if (!window.strapi.isEE || !(options == null ? void 0 : options.reviewWorkflows) || collectionType !== "single-types" && !id || id === "create") {
    return null;
  }
  return {
    title: formatMessage({
      id: "content-manager.containers.edit.panels.review-workflows.title",
      defaultMessage: "Review Workflows"
    }),
    content: (0, import_jsx_runtime16.jsxs)(Flex, {
      direction: "column",
      gap: 2,
      alignItems: "stretch",
      width: "100%",
      children: [
        (0, import_jsx_runtime16.jsx)(AssigneeSelect, {}),
        (0, import_jsx_runtime16.jsx)(StageSelect, {})
      ]
    })
  };
};
Panel2.type = "review-workflows";

// node_modules/@strapi/review-workflows/dist/admin/routes/content-manager/model/constants.mjs
var import_jsx_runtime17 = __toESM(require_jsx_runtime(), 1);
var import_react6 = __toESM(require_react(), 1);
var REVIEW_WORKFLOW_COLUMNS = [
  {
    name: STAGE_ATTRIBUTE_NAME,
    attribute: {
      type: "relation",
      relation: "oneToMany",
      target: "admin::review-workflow-stage"
    },
    label: {
      id: "review-workflows.containers.list.table-headers.reviewWorkflows.stage",
      defaultMessage: "Review stage"
    },
    searchable: false,
    sortable: true,
    mainField: {
      name: "name",
      type: "string"
    },
    cellFormatter: (props) => (0, import_jsx_runtime17.jsx)(StageColumn, {
      ...props
    })
  },
  {
    name: ASSIGNEE_ATTRIBUTE_NAME,
    attribute: {
      type: "relation",
      target: "admin::user",
      relation: "oneToMany"
    },
    label: {
      id: "review-workflows.containers.list.table-headers.reviewWorkflows.assignee",
      defaultMessage: "Assignee"
    },
    searchable: false,
    sortable: true,
    mainField: {
      name: "firstname",
      type: "string"
    },
    cellFormatter: (props) => (0, import_jsx_runtime17.jsx)(AssigneeColumn, {
      ...props
    })
  }
];

// node_modules/@strapi/review-workflows/dist/admin/utils/cm-hooks.mjs
var addColumnToTableHook3 = ({ displayedHeaders, layout }) => {
  const { options } = layout;
  if (!options.reviewWorkflows) {
    return {
      displayedHeaders,
      layout
    };
  }
  return {
    displayedHeaders: [
      ...displayedHeaders,
      ...REVIEW_WORKFLOW_COLUMNS
    ],
    layout
  };
};

// node_modules/@strapi/review-workflows/dist/admin/utils/translations.mjs
var prefixPluginTranslations4 = (trad, pluginId3) => {
  return Object.keys(trad).reduce((acc, current) => {
    acc[`${pluginId3}.${current}`] = trad[current];
    return acc;
  }, {});
};

// node_modules/@strapi/review-workflows/dist/admin/index.mjs
function __variableDynamicImportRuntime3__(path) {
  switch (path) {
    case "./translations/en.json":
      return import("./en.json-ENGJRNIX.js");
    case "./translations/uk.json":
      return import("./uk.json-AEVQXBJA.js");
    default:
      return new Promise(function(resolve, reject) {
        (typeof queueMicrotask === "function" ? queueMicrotask : setTimeout)(
          reject.bind(null, new Error("Unknown variable dynamic import: " + path))
        );
      });
  }
}
var admin4 = {
  register(app) {
    var _a, _b;
    if (window.strapi.features.isEnabled(FEATURE_ID)) {
      app.registerHook("Admin/CM/pages/ListView/inject-column-in-table", addColumnToTableHook3);
      const contentManagerPluginApis = app.getPlugin("content-manager").apis;
      if ("addEditViewSidePanel" in contentManagerPluginApis && typeof contentManagerPluginApis.addEditViewSidePanel === "function") {
        contentManagerPluginApis.addEditViewSidePanel([
          Panel2
        ]);
      }
      app.addSettingsLink("global", {
        id: PLUGIN_ID2,
        to: `review-workflows`,
        intlLabel: {
          id: `${PLUGIN_ID2}.plugin.name`,
          defaultMessage: "Review Workflows"
        },
        licenseOnly: true,
        permissions: [],
        async Component() {
          const { Router } = await import("./router-JWCRHEVK.js");
          return {
            default: Router
          };
        }
      });
      app.widgets.register((widgets) => [
        ...widgets,
        {
          icon: ForwardRef$11,
          title: {
            id: `${PLUGIN_ID2}.widget.assigned.title`,
            defaultMessage: "Assigned to me"
          },
          component: async () => {
            const { AssignedWidget } = await import("./Widgets-ILJRM2XW.js");
            return AssignedWidget;
          },
          pluginId: PLUGIN_ID2,
          id: "assigned",
          permissions: [
            {
              action: "plugin::content-manager.explorer.read"
            }
          ]
        }
      ]);
    } else if (!window.strapi.features.isEnabled(FEATURE_ID) && ((_b = (_a = window.strapi) == null ? void 0 : _a.flags) == null ? void 0 : _b.promoteEE)) {
      app.addSettingsLink("global", {
        id: PLUGIN_ID2,
        to: `purchase-review-workflows`,
        intlLabel: {
          id: `${PLUGIN_ID2}.plugin.name`,
          defaultMessage: "Review Workflows"
        },
        licenseOnly: true,
        permissions: [],
        async Component() {
          const { PurchaseReviewWorkflows } = await import("./purchase-review-workflows-D6BJKF6G.js");
          return {
            default: PurchaseReviewWorkflows
          };
        }
      });
    }
  },
  bootstrap(app) {
    if (window.strapi.features.isEnabled(FEATURE_ID)) {
      app.getPlugin("content-manager").injectComponent("preview", "actions", {
        name: "review-workflows-assignee",
        Component: Header
      });
    }
  },
  async registerTrads({ locales }) {
    const importedTrads = await Promise.all(locales.map((locale) => {
      return __variableDynamicImportRuntime3__(`./translations/${locale}.json`).then(({ default: data }) => {
        return {
          data: prefixPluginTranslations4(data, PLUGIN_ID2),
          locale
        };
      }).catch(() => {
        return {
          data: {},
          locale
        };
      });
    }));
    return Promise.resolve(importedTrads);
  }
};

// node_modules/@strapi/strapi/dist/admin.mjs
var render = (mountNode, { plugins, ...restArgs }) => {
  return renderAdmin(mountNode, {
    ...restArgs,
    plugins: {
      "content-manager": index2,
      "content-type-builder": index,
      email: admin2,
      upload: admin,
      contentReleases: admin3,
      i18n: index3,
      reviewWorkflows: admin4,
      ...plugins
    }
  });
};

export {
  render
};
//# sourceMappingURL=chunk-M7P4CMML.js.map
