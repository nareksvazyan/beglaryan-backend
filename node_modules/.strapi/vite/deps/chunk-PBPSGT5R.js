import {
  AssetGridList,
  AudioPreview,
  Breadcrumbs,
  CopyLinkButton,
  EditAssetContent,
  EditAssetDialog,
  EditFolderContent,
  EditFolderDialog,
  EmptyAssets,
  FilterList,
  FilterPopover,
  FolderCard,
  FolderCardBody,
  FolderCardBodyAction,
  FolderGridList,
  SortPicker,
  TableList,
  UploadAssetDialog,
  VideoPreview,
  containsAssetFilter,
  createAssetUrl,
  displayedFilters,
  prefixFileUrlWithBackendUrl,
  rawFileToAsset,
  useAssets,
  useFolder,
  useFolders,
  useMediaLibraryPermissions,
  usePersistentState,
  useSelectionState
} from "./chunk-JDAIPPMW.js";
import {
  useConfig
} from "./chunk-XZ6ULFPZ.js";
import {
  AssetSource,
  AssetType,
  PERMISSIONS,
  getTrad,
  localStorageKeys,
  pluginId,
  pluginPkg,
  viewOptions
} from "./chunk-N5MOM536.js";
import {
  useTracking
} from "./chunk-QBOU5KNS.js";
import {
  useField
} from "./chunk-B53TSE6I.js";
import {
  Page
} from "./chunk-IATSSX5S.js";
import {
  useNotification
} from "./chunk-K6X2HFMR.js";
import {
  require_lib
} from "./chunk-IJRBMRJB.js";
import {
  Badge,
  Box,
  Button,
  CarouselActions,
  CarouselInput,
  CarouselSlide,
  CheckboxImpl,
  Divider,
  Flex,
  Grid,
  IconButton,
  Loader,
  Modal,
  Popover,
  SearchForm,
  Searchbar,
  SingleSelect,
  SingleSelectOption,
  Tabs,
  Typography,
  VisuallyHidden,
  useIntl
} from "./chunk-4UXIB2ZA.js";
import {
  ForwardRef$$,
  ForwardRef$1j,
  ForwardRef$1l,
  ForwardRef$1z,
  ForwardRef$2N,
  ForwardRef$2t,
  ForwardRef$3D,
  ForwardRef$3d,
  ForwardRef$3p,
  ForwardRef$3x,
  ForwardRef$4D,
  ForwardRef$4F,
  ForwardRef$n
} from "./chunk-67WISF62.js";
import {
  require_jsx_runtime
} from "./chunk-NIAJZ5MX.js";
import {
  at,
  rt
} from "./chunk-IUZOBZCP.js";
import {
  require_react
} from "./chunk-MADUDGYZ.js";
import {
  __toESM
} from "./chunk-PLDDJCW6.js";

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryDialog/MediaLibraryDialog.mjs
var import_jsx_runtime10 = __toESM(require_jsx_runtime(), 1);
var React6 = __toESM(require_react(), 1);

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/AssetDialog.mjs
var import_jsx_runtime9 = __toESM(require_jsx_runtime(), 1);
var React5 = __toESM(require_react(), 1);

// node_modules/@strapi/upload/dist/admin/hooks/useModalQueryParams.mjs
var React = __toESM(require_react(), 1);
var import_qs = __toESM(require_lib(), 1);
var useModalQueryParams = (initialState) => {
  const { trackUsage } = useTracking();
  const { config: { data: config } } = useConfig();
  const [queryObject, setQueryObject] = React.useState({
    page: 1,
    sort: "updatedAt:DESC",
    pageSize: 10,
    filters: {
      $and: []
    },
    ...initialState
  });
  React.useEffect(() => {
    if (config && "sort" in config && "pageSize" in config) {
      setQueryObject((prevQuery) => ({
        ...prevQuery,
        sort: config.sort,
        pageSize: config.pageSize
      }));
    }
  }, [
    config
  ]);
  const handleChangeFilters = (nextFilters) => {
    if (nextFilters) {
      trackUsage("didFilterMediaLibraryElements", {
        location: "content-manager",
        filter: Object.keys(nextFilters[nextFilters.length - 1])[0]
      });
      setQueryObject((prev) => ({
        ...prev,
        page: 1,
        filters: {
          $and: nextFilters
        }
      }));
    }
  };
  const handleChangePageSize = (pageSize) => {
    setQueryObject((prev) => ({
      ...prev,
      pageSize: typeof pageSize === "string" ? parseInt(pageSize, 10) : pageSize,
      page: 1
    }));
  };
  const handeChangePage = (page) => {
    setQueryObject((prev) => ({
      ...prev,
      page
    }));
  };
  const handleChangeSort = (sort) => {
    if (sort) {
      trackUsage("didSortMediaLibraryElements", {
        location: "content-manager",
        sort
      });
      setQueryObject((prev) => ({
        ...prev,
        sort
      }));
    }
  };
  const handleChangeSearch = (_q) => {
    if (_q) {
      setQueryObject((prev) => ({
        ...prev,
        _q,
        page: 1
      }));
    } else {
      const newState = {
        page: 1
      };
      Object.keys(queryObject).forEach((key) => {
        if (![
          "page",
          "_q"
        ].includes(key)) {
          newState[key] = queryObject[key];
        }
      });
      setQueryObject(newState);
    }
  };
  const handleChangeFolder = (folder, folderPath) => {
    setQueryObject((prev) => ({
      ...prev,
      folder: folder ?? null,
      folderPath
    }));
  };
  return [
    {
      queryObject,
      rawQuery: (0, import_qs.stringify)(queryObject, {
        encode: false
      })
    },
    {
      onChangeFilters: handleChangeFilters,
      onChangeFolder: handleChangeFolder,
      onChangePage: handeChangePage,
      onChangePageSize: handleChangePageSize,
      onChangeSort: handleChangeSort,
      onChangeSearch: handleChangeSearch
    }
  ];
};

// node_modules/@strapi/upload/dist/admin/utils/toSingularTypes.mjs
var toSingularTypes = (types) => {
  if (!types) {
    return [];
  }
  return types.map((type) => type.substring(0, type.length - 1));
};

// node_modules/@strapi/upload/dist/admin/utils/getAllowedFiles.mjs
var getAllowedFiles = (pluralTypes, files) => {
  if (!pluralTypes) {
    return files;
  }
  const singularTypes = toSingularTypes(pluralTypes);
  const allowedFiles = files.filter((file) => {
    var _a;
    const fileType = (_a = file == null ? void 0 : file.mime) == null ? void 0 : _a.split("/")[0];
    if (!fileType) {
      return false;
    }
    if (singularTypes.includes("file") && ![
      "video",
      "image",
      "audio"
    ].includes(fileType)) {
      return true;
    }
    return singularTypes.includes(fileType);
  });
  return allowedFiles;
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/AssetDialog.mjs
var import_qs6 = __toESM(require_lib(), 1);

// node_modules/@strapi/upload/dist/admin/utils/moveElement.mjs
var move = (array, oldIndex, newIndex) => {
  if (newIndex >= array.length) {
    newIndex = array.length - 1;
  }
  array.splice(newIndex, 0, array.splice(oldIndex, 1)[0]);
  return array;
};
var moveElement = (array, index, offset) => {
  const newIndex = index + offset;
  return move(array, index, newIndex);
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/BrowseStep.mjs
var import_jsx_runtime6 = __toESM(require_jsx_runtime(), 1);

// node_modules/@strapi/upload/dist/admin/utils/getBreadcrumbDataCM.mjs
var getBreadcrumbDataCM = (folder) => {
  var _a;
  const data = [
    {
      id: null,
      label: {
        id: getTrad("plugin.name"),
        defaultMessage: "Media Library"
      }
    }
  ];
  if ((_a = folder == null ? void 0 : folder.parent) == null ? void 0 : _a.parent) {
    data.push([]);
  }
  if (folder == null ? void 0 : folder.parent) {
    data.push({
      id: folder.parent.id,
      label: folder.parent.name,
      path: folder.parent.path
    });
  }
  if (folder) {
    data.push({
      id: folder.id,
      label: folder.name,
      path: folder.path
    });
  }
  return data;
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/BrowseStep.mjs
var import_qs4 = __toESM(require_lib(), 1);

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/Filters.mjs
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
var React2 = __toESM(require_react(), 1);
var import_qs2 = __toESM(require_lib(), 1);
var Filters = ({ appliedFilters, onChangeFilters }) => {
  const [open, setOpen] = React2.useState(false);
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime.jsxs)(Popover.Root, {
    open,
    onOpenChange: setOpen,
    children: [
      (0, import_jsx_runtime.jsx)(Popover.Trigger, {
        children: (0, import_jsx_runtime.jsx)(Button, {
          variant: "tertiary",
          startIcon: (0, import_jsx_runtime.jsx)(ForwardRef$3p, {}),
          size: "S",
          children: formatMessage({
            id: "app.utils.filters",
            defaultMessage: "Filters"
          })
        })
      }),
      (0, import_jsx_runtime.jsx)(FilterPopover, {
        onToggle: () => setOpen((prev) => !prev),
        displayedFilters,
        filters: appliedFilters,
        onSubmit: onChangeFilters
      }),
      appliedFilters && (0, import_jsx_runtime.jsx)(FilterList, {
        appliedFilters,
        filtersSchema: displayedFilters,
        onRemoveFilter: onChangeFilters
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/PageSize.mjs
var import_jsx_runtime2 = __toESM(require_jsx_runtime(), 1);
var PageSize = ({ onChangePageSize, pageSize }) => {
  const { formatMessage } = useIntl();
  const handleChange = (value) => {
    onChangePageSize(Number(value));
  };
  return (0, import_jsx_runtime2.jsxs)(Flex, {
    children: [
      (0, import_jsx_runtime2.jsxs)(SingleSelect, {
        size: "S",
        "aria-label": formatMessage({
          id: "components.PageFooter.select",
          defaultMessage: "Entries per page"
        }),
        onChange: handleChange,
        value: pageSize.toString(),
        children: [
          (0, import_jsx_runtime2.jsx)(SingleSelectOption, {
            value: "10",
            children: "10"
          }),
          (0, import_jsx_runtime2.jsx)(SingleSelectOption, {
            value: "20",
            children: "20"
          }),
          (0, import_jsx_runtime2.jsx)(SingleSelectOption, {
            value: "50",
            children: "50"
          }),
          (0, import_jsx_runtime2.jsx)(SingleSelectOption, {
            value: "100",
            children: "100"
          })
        ]
      }),
      (0, import_jsx_runtime2.jsx)(Box, {
        paddingLeft: 2,
        children: (0, import_jsx_runtime2.jsx)(Typography, {
          textColor: "neutral600",
          tag: "label",
          htmlFor: "page-size",
          children: formatMessage({
            id: "components.PageFooter.select",
            defaultMessage: "Entries per page"
          })
        })
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/PaginationFooter/PaginationFooter.mjs
var import_jsx_runtime4 = __toESM(require_jsx_runtime(), 1);

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/PaginationFooter/Pagination.mjs
var import_jsx_runtime3 = __toESM(require_jsx_runtime(), 1);
var React3 = __toESM(require_react(), 1);
var PaginationContext = React3.createContext({
  activePage: 1,
  pageCount: 1
});
var usePagination = () => React3.useContext(PaginationContext);
var Pagination = ({ children, activePage, pageCount, label = "pagination" }) => {
  const paginationValue = React3.useMemo(() => ({
    activePage,
    pageCount
  }), [
    activePage,
    pageCount
  ]);
  return (0, import_jsx_runtime3.jsx)(PaginationContext.Provider, {
    value: paginationValue,
    children: (0, import_jsx_runtime3.jsx)(Box, {
      tag: "nav",
      "aria-label": label,
      children: (0, import_jsx_runtime3.jsx)(Flex, {
        tag: "ul",
        gap: 1,
        children
      })
    })
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/PaginationFooter/PaginationFooter.mjs
var PaginationText = at(Typography)`
  line-height: revert;
`;
var linkWrapperStyles = rt`
  padding: ${({ theme }) => theme.spaces[3]};
  border-radius: ${({ theme }) => theme.borderRadius};
  box-shadow: ${({ $active, theme }) => $active ? theme.shadows.filterShadow : void 0};
  text-decoration: none;
  display: flex;
  position: relative;
  outline: none;

  &:after {
    transition-property: all;
    transition-duration: 0.2s;
    border-radius: 8px;
    content: '';
    position: absolute;
    top: -4px;
    bottom: -4px;
    left: -4px;
    right: -4px;
    border: 2px solid transparent;
  }

  &:focus-visible {
    outline: none;

    &:after {
      border-radius: 8px;
      content: '';
      position: absolute;
      top: -5px;
      bottom: -5px;
      left: -5px;
      right: -5px;
      border: 2px solid ${(props) => props.theme.colors.primary600};
    }
  }
`;
var LinkWrapperButton = at.button`
  ${linkWrapperStyles}
`;
var LinkWrapperDiv = at.div`
  ${linkWrapperStyles}
`;
LinkWrapperButton.defaultProps = {
  type: "button"
};
var PageLinkWrapper = at(LinkWrapperButton)`
  color: ${({ theme, $active }) => $active ? theme.colors.primary700 : theme.colors.neutral800};
  background: ${({ theme, $active }) => $active ? theme.colors.neutral0 : void 0};

  &:hover {
    box-shadow: ${({ theme }) => theme.shadows.filterShadow};
  }
`;
var ActionLinkWrapper = at(LinkWrapperButton)`
  font-size: 1.1rem;
  svg path {
    fill: ${(p) => p["aria-disabled"] ? p.theme.colors.neutral300 : p.theme.colors.neutral600};
  }

  &:focus,
  &:hover {
    svg path {
      fill: ${(p) => p["aria-disabled"] ? p.theme.colors.neutral300 : p.theme.colors.neutral700};
    }
  }

  ${(p) => p["aria-disabled"] ? `
  pointer-events: none;
    ` : void 0}
`;
var DotsWrapper = at(LinkWrapperDiv)`
  color: ${({ theme }) => theme.colors.neutral800};
`;
var PreviousLink = ({ children, ...props }) => {
  const { activePage } = usePagination();
  const disabled = activePage === 1;
  return (0, import_jsx_runtime4.jsx)("li", {
    children: (0, import_jsx_runtime4.jsxs)(ActionLinkWrapper, {
      "aria-disabled": disabled,
      tabIndex: disabled ? -1 : void 0,
      ...props,
      children: [
        (0, import_jsx_runtime4.jsx)(VisuallyHidden, {
          children
        }),
        (0, import_jsx_runtime4.jsx)(ForwardRef$4F, {
          "aria-hidden": true
        })
      ]
    })
  });
};
var NextLink = ({ children, ...props }) => {
  const { activePage, pageCount } = usePagination();
  const disabled = activePage === pageCount;
  return (0, import_jsx_runtime4.jsx)("li", {
    children: (0, import_jsx_runtime4.jsxs)(ActionLinkWrapper, {
      "aria-disabled": disabled,
      tabIndex: disabled ? -1 : void 0,
      ...props,
      children: [
        (0, import_jsx_runtime4.jsx)(VisuallyHidden, {
          children
        }),
        (0, import_jsx_runtime4.jsx)(ForwardRef$4D, {
          "aria-hidden": true
        })
      ]
    })
  });
};
var PageLink = ({ number, children, ...props }) => {
  const { activePage } = usePagination();
  const isActive = activePage === number;
  return (0, import_jsx_runtime4.jsx)("li", {
    children: (0, import_jsx_runtime4.jsxs)(PageLinkWrapper, {
      ...props,
      $active: isActive,
      children: [
        (0, import_jsx_runtime4.jsx)(VisuallyHidden, {
          children
        }),
        (0, import_jsx_runtime4.jsx)(PaginationText, {
          "aria-hidden": true,
          variant: "pi",
          fontWeight: isActive ? "bold" : "",
          children: number
        })
      ]
    })
  });
};
var Dots = ({ children, ...props }) => (0, import_jsx_runtime4.jsx)("li", {
  children: (0, import_jsx_runtime4.jsxs)(DotsWrapper, {
    ...props,
    as: "div",
    children: [
      (0, import_jsx_runtime4.jsx)(VisuallyHidden, {
        children
      }),
      (0, import_jsx_runtime4.jsx)(PaginationText, {
        "aria-hidden": true,
        small: true,
        children: "â€¦"
      })
    ]
  })
});
var PaginationFooter = ({ activePage, onChangePage, pagination: { pageCount } }) => {
  const { formatMessage } = useIntl();
  const previousActivePage = activePage - 1;
  const nextActivePage = activePage + 1;
  const firstLinks = [
    (0, import_jsx_runtime4.jsx)(PageLink, {
      number: 1,
      onClick: () => {
        onChangePage(1);
      },
      children: formatMessage({
        id: "components.pagination.go-to",
        defaultMessage: "Go to page {page}"
      }, {
        page: 1
      })
    }, 1)
  ];
  if (pageCount <= 4) {
    const links = Array.from({
      length: pageCount
    }).map((_, i) => i + 1).map((number) => {
      return (0, import_jsx_runtime4.jsx)(PageLink, {
        number,
        onClick: () => onChangePage(number),
        children: formatMessage({
          id: "components.pagination.go-to",
          defaultMessage: "Go to page {page}"
        }, {
          page: number
        })
      }, number);
    });
    return (0, import_jsx_runtime4.jsxs)(Pagination, {
      activePage,
      pageCount,
      children: [
        (0, import_jsx_runtime4.jsx)(PreviousLink, {
          onClick: () => onChangePage(previousActivePage),
          children: formatMessage({
            id: "components.pagination.go-to-previous",
            defaultMessage: "Go to previous page"
          })
        }),
        links,
        (0, import_jsx_runtime4.jsx)(NextLink, {
          onClick: () => onChangePage(nextActivePage),
          children: formatMessage({
            id: "components.pagination.go-to-next",
            defaultMessage: "Go to next page"
          })
        })
      ]
    });
  }
  let firstLinksToCreate = [];
  const lastLinks = [];
  let lastLinksToCreate = [];
  const middleLinks = [];
  if (pageCount > 1) {
    lastLinks.push((0, import_jsx_runtime4.jsx)(PageLink, {
      number: pageCount,
      onClick: () => onChangePage(pageCount),
      children: formatMessage({
        id: "components.pagination.go-to",
        defaultMessage: "Go to page {page}"
      }, {
        page: pageCount
      })
    }, pageCount));
  }
  if (activePage === 1 && pageCount >= 3) {
    firstLinksToCreate = [
      2
    ];
  }
  if (activePage === 2 && pageCount >= 3) {
    if (pageCount === 5) {
      firstLinksToCreate = [
        2,
        3,
        4
      ];
    } else if (pageCount === 3) {
      firstLinksToCreate = [
        2
      ];
    } else {
      firstLinksToCreate = [
        2,
        3
      ];
    }
  }
  if (activePage === 4 && pageCount >= 3) {
    firstLinksToCreate = [
      2
    ];
  }
  if (activePage === pageCount && pageCount >= 3) {
    lastLinksToCreate = [
      pageCount - 1
    ];
  }
  if (activePage === pageCount - 2 && pageCount > 3) {
    lastLinksToCreate = [
      activePage + 1,
      activePage,
      activePage - 1
    ];
  }
  if (activePage === pageCount - 3 && pageCount > 3 && activePage > 5) {
    lastLinksToCreate = [
      activePage + 2,
      activePage + 1,
      activePage,
      activePage - 1
    ];
  }
  if (activePage === pageCount - 1 && pageCount > 3) {
    lastLinksToCreate = [
      activePage,
      activePage - 1
    ];
  }
  lastLinksToCreate.forEach((number) => {
    lastLinks.unshift((0, import_jsx_runtime4.jsxs)(PageLink, {
      number,
      onClick: () => onChangePage(number),
      children: [
        "Go to page ",
        number
      ]
    }, number));
  });
  firstLinksToCreate.forEach((number) => {
    firstLinks.push((0, import_jsx_runtime4.jsx)(PageLink, {
      number,
      onClick: () => onChangePage(number),
      children: formatMessage({
        id: "components.pagination.go-to",
        defaultMessage: "Go to page {page}"
      }, {
        page: number
      })
    }, number));
  });
  if (![
    1,
    2
  ].includes(activePage) && activePage <= pageCount - 3 && firstLinks.length + lastLinks.length < 6) {
    const middleLinksToCreate = [
      activePage - 1,
      activePage,
      activePage + 1
    ];
    middleLinksToCreate.forEach((number) => {
      middleLinks.push((0, import_jsx_runtime4.jsx)(PageLink, {
        number,
        onClick: () => onChangePage(number),
        children: formatMessage({
          id: "components.pagination.go-to",
          defaultMessage: "Go to page {page}"
        }, {
          page: number
        })
      }, number));
    });
  }
  const shouldShowDotsAfterFirstLink = pageCount > 5 || pageCount === 5 && (activePage === 1 || activePage === 5);
  const shouldShowMiddleDots = middleLinks.length > 2 && activePage > 4 && pageCount > 5;
  const beforeDotsLinksLength = shouldShowMiddleDots ? pageCount - activePage - 1 : pageCount - firstLinks.length - lastLinks.length;
  const afterDotsLength = shouldShowMiddleDots ? pageCount - firstLinks.length - lastLinks.length : pageCount - activePage - 1;
  return (0, import_jsx_runtime4.jsxs)(Pagination, {
    activePage,
    pageCount,
    children: [
      (0, import_jsx_runtime4.jsx)(PreviousLink, {
        onClick: () => onChangePage(previousActivePage),
        children: formatMessage({
          id: "components.pagination.go-to-previous",
          defaultMessage: "Go to previous page"
        })
      }),
      firstLinks,
      shouldShowMiddleDots && (0, import_jsx_runtime4.jsx)(Dots, {
        children: formatMessage({
          id: "components.pagination.remaining-links",
          defaultMessage: "And {number} other links"
        }, {
          number: beforeDotsLinksLength
        })
      }),
      middleLinks,
      shouldShowDotsAfterFirstLink && (0, import_jsx_runtime4.jsx)(Dots, {
        children: formatMessage({
          id: "components.pagination.remaining-links",
          defaultMessage: "And {number} other links"
        }, {
          number: afterDotsLength
        })
      }),
      lastLinks,
      (0, import_jsx_runtime4.jsx)(NextLink, {
        onClick: () => onChangePage(nextActivePage),
        children: formatMessage({
          id: "components.pagination.go-to-next",
          defaultMessage: "Go to next page"
        })
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/SearchAsset/SearchAsset.mjs
var import_jsx_runtime5 = __toESM(require_jsx_runtime(), 1);
var React4 = __toESM(require_react(), 1);
var import_qs3 = __toESM(require_lib(), 1);
var SearchAsset = ({ onChangeSearch, queryValue = null }) => {
  const { formatMessage } = useIntl();
  const { trackUsage } = useTracking();
  const [isOpen, setIsOpen] = React4.useState(!!queryValue);
  const [value, setValue] = React4.useState(queryValue || "");
  const wrapperRef = React4.useRef(null);
  React4.useLayoutEffect(() => {
    if (isOpen) {
      setTimeout(() => {
        var _a, _b;
        (_b = (_a = wrapperRef.current) == null ? void 0 : _a.querySelector("input")) == null ? void 0 : _b.focus();
      }, 0);
    }
  }, [
    isOpen
  ]);
  const handleToggle = () => {
    setIsOpen((prev) => !prev);
  };
  const handleClear = () => {
    handleToggle();
    onChangeSearch(null);
  };
  const handleSubmit = (e) => {
    e.preventDefault();
    e.stopPropagation();
    trackUsage("didSearchMediaLibraryElements", {
      location: "content-manager"
    });
    onChangeSearch(value);
  };
  if (isOpen) {
    return (0, import_jsx_runtime5.jsx)("div", {
      ref: wrapperRef,
      children: (0, import_jsx_runtime5.jsx)(SearchForm, {
        onSubmit: handleSubmit,
        children: (0, import_jsx_runtime5.jsx)(Searchbar, {
          name: "search",
          onClear: handleClear,
          onChange: (e) => setValue(e.target.value),
          clearLabel: formatMessage({
            id: getTrad("search.clear.label"),
            defaultMessage: "Clear the search"
          }),
          "aria-label": "search",
          size: "S",
          value,
          placeholder: formatMessage({
            id: getTrad("search.placeholder"),
            defaultMessage: "e.g: the first dog on the moon"
          }),
          children: formatMessage({
            id: getTrad("search.label"),
            defaultMessage: "Search for an asset"
          })
        })
      })
    });
  }
  return (0, import_jsx_runtime5.jsx)(IconButton, {
    label: "Search",
    onClick: handleToggle,
    children: (0, import_jsx_runtime5.jsx)(ForwardRef$$, {})
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/utils/isSelectable.mjs
var isSelectable = (allowedTypes, mime = "") => {
  if (!mime) return false;
  const fileType = mime.split("/")[0];
  return allowedTypes.includes(fileType) || allowedTypes.includes("file") && ![
    "video",
    "image",
    "audio"
  ].includes(fileType);
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/BrowseStep/BrowseStep.mjs
var TypographyMaxWidth = at(Typography)`
  max-width: 100%;
`;
var ActionContainer = at(Box)`
  svg {
    path {
      fill: ${({ theme }) => theme.colors.neutral500};
    }
  }
`;
var BrowseStep = ({ allowedTypes = [], assets: rawAssets, canCreate, canRead, folders = [], multiple = false, onAddAsset, onChangeFilters, onChangePage, onChangePageSize, onChangeSearch, onChangeSort, onChangeFolder, onEditAsset, onEditFolder, onSelectAllAsset, onSelectAsset, pagination, queryObject, selectedAssets }) => {
  var _a, _b, _c;
  const { formatMessage } = useIntl();
  const [view, setView] = usePersistentState(localStorageKeys.modalView, viewOptions.GRID);
  const isGridView = view === viewOptions.GRID;
  const { data: currentFolder, isLoading: isCurrentFolderLoading } = useFolder(queryObject == null ? void 0 : queryObject.folder, {
    enabled: canRead && !!(queryObject == null ? void 0 : queryObject.folder)
  });
  const singularTypes = toSingularTypes(allowedTypes);
  const assets = rawAssets.map((asset) => ({
    ...asset,
    isSelectable: isSelectable(singularTypes, asset == null ? void 0 : asset.mime),
    type: "asset"
  }));
  const breadcrumbs = !isCurrentFolderLoading ? getBreadcrumbDataCM(currentFolder) : void 0;
  const allAllowedAsset = getAllowedFiles(allowedTypes, assets);
  const areAllAssetSelected = allAllowedAsset.length > 0 && selectedAssets.length > 0 && allAllowedAsset.every((asset) => selectedAssets.findIndex((currAsset) => currAsset.id === asset.id) !== -1);
  const hasSomeAssetSelected = allAllowedAsset.some((asset) => selectedAssets.findIndex((currAsset) => currAsset.id === asset.id) !== -1);
  const isSearching = !!(queryObject == null ? void 0 : queryObject._q);
  const isFiltering = !!((_b = (_a = queryObject == null ? void 0 : queryObject.filters) == null ? void 0 : _a.$and) == null ? void 0 : _b.length) && queryObject.filters.$and.length > 0;
  const isSearchingOrFiltering = isSearching || isFiltering;
  const assetCount = assets.length;
  const folderCount = folders.length;
  const handleClickFolderCard = (...args) => {
    onChangeSearch("");
    onChangeFolder(...args);
  };
  return (0, import_jsx_runtime6.jsxs)(Box, {
    children: [
      onSelectAllAsset && (0, import_jsx_runtime6.jsx)(Box, {
        paddingBottom: 4,
        children: (0, import_jsx_runtime6.jsxs)(Flex, {
          justifyContent: "space-between",
          alignItems: "flex-start",
          children: [
            (assetCount > 0 || folderCount > 0 || isFiltering) && (0, import_jsx_runtime6.jsxs)(Flex, {
              gap: 2,
              wrap: "wrap",
              children: [
                multiple && isGridView && (0, import_jsx_runtime6.jsx)(Flex, {
                  paddingLeft: 2,
                  paddingRight: 2,
                  background: "neutral0",
                  hasRadius: true,
                  borderColor: "neutral200",
                  height: "3.2rem",
                  children: (0, import_jsx_runtime6.jsx)(CheckboxImpl, {
                    "aria-label": formatMessage({
                      id: getTrad("bulk.select.label"),
                      defaultMessage: "Select all assets"
                    }),
                    checked: !areAllAssetSelected && hasSomeAssetSelected ? "indeterminate" : areAllAssetSelected,
                    onCheckedChange: onSelectAllAsset
                  })
                }),
                isGridView && (0, import_jsx_runtime6.jsx)(SortPicker, {
                  onChangeSort,
                  value: queryObject == null ? void 0 : queryObject.sort
                }),
                (0, import_jsx_runtime6.jsx)(Filters, {
                  appliedFilters: (_c = queryObject == null ? void 0 : queryObject.filters) == null ? void 0 : _c.$and,
                  onChangeFilters
                })
              ]
            }),
            (assetCount > 0 || folderCount > 0 || isSearching) && (0, import_jsx_runtime6.jsxs)(Flex, {
              marginLeft: "auto",
              shrink: 0,
              gap: 2,
              children: [
                (0, import_jsx_runtime6.jsx)(ActionContainer, {
                  paddingTop: 1,
                  paddingBottom: 1,
                  children: (0, import_jsx_runtime6.jsx)(IconButton, {
                    label: isGridView ? formatMessage({
                      id: "view-switch.list",
                      defaultMessage: "List View"
                    }) : formatMessage({
                      id: "view-switch.grid",
                      defaultMessage: "Grid View"
                    }),
                    onClick: () => setView(isGridView ? viewOptions.LIST : viewOptions.GRID),
                    children: isGridView ? (0, import_jsx_runtime6.jsx)(ForwardRef$2t, {}) : (0, import_jsx_runtime6.jsx)(ForwardRef$3d, {})
                  })
                }),
                (0, import_jsx_runtime6.jsx)(SearchAsset, {
                  onChangeSearch,
                  queryValue: queryObject._q || ""
                })
              ]
            })
          ]
        })
      }),
      canRead && (breadcrumbs == null ? void 0 : breadcrumbs.length) && breadcrumbs.length > 0 && currentFolder && (0, import_jsx_runtime6.jsx)(Box, {
        paddingTop: 3,
        children: (0, import_jsx_runtime6.jsx)(Breadcrumbs, {
          onChangeFolder,
          label: formatMessage({
            id: getTrad("header.breadcrumbs.nav.label"),
            defaultMessage: "Folders navigation"
          }),
          breadcrumbs,
          currentFolderId: queryObject == null ? void 0 : queryObject.folder
        })
      }),
      assetCount === 0 && folderCount === 0 && (0, import_jsx_runtime6.jsx)(Box, {
        paddingBottom: 6,
        children: (0, import_jsx_runtime6.jsx)(EmptyAssets, {
          size: "S",
          count: 6,
          action: canCreate && !isFiltering && !isSearching && (0, import_jsx_runtime6.jsx)(Button, {
            variant: "secondary",
            startIcon: (0, import_jsx_runtime6.jsx)(ForwardRef$1l, {}),
            onClick: onAddAsset,
            children: formatMessage({
              id: getTrad("header.actions.add-assets"),
              defaultMessage: "Add new assets"
            })
          }),
          content: (
            // eslint-disable-next-line no-nested-ternary
            isSearchingOrFiltering ? formatMessage({
              id: getTrad("list.assets-empty.title-withSearch"),
              defaultMessage: "There are no assets with the applied filters"
            }) : canCreate && !isSearching ? formatMessage({
              id: getTrad("list.assets.empty"),
              defaultMessage: "Upload your first assets..."
            }) : formatMessage({
              id: getTrad("list.assets.empty.no-permissions"),
              defaultMessage: "The asset list is empty"
            })
          )
        })
      }),
      !isGridView && (folderCount > 0 || assetCount > 0) && (0, import_jsx_runtime6.jsx)(TableList, {
        allowedTypes,
        assetCount,
        folderCount,
        indeterminate: !areAllAssetSelected && hasSomeAssetSelected,
        isFolderSelectionAllowed: false,
        onChangeSort,
        onChangeFolder: handleClickFolderCard,
        onEditAsset,
        onEditFolder,
        onSelectOne: onSelectAsset,
        onSelectAll: onSelectAllAsset,
        rows: [
          ...folders.map((folder) => ({
            ...folder,
            type: "folder"
          })),
          ...assets
        ],
        selected: selectedAssets,
        shouldDisableBulkSelect: !multiple,
        sortQuery: (queryObject == null ? void 0 : queryObject.sort) ?? ""
      }),
      isGridView && (0, import_jsx_runtime6.jsxs)(import_jsx_runtime6.Fragment, {
        children: [
          folderCount > 0 && (0, import_jsx_runtime6.jsx)(FolderGridList, {
            title: (isSearchingOrFiltering && assetCount > 0 || !isSearchingOrFiltering) && formatMessage({
              id: getTrad("list.folders.title"),
              defaultMessage: "Folders ({count})"
            }, {
              count: folderCount
            }) || "",
            children: folders.map((folder) => {
              var _a2, _b2;
              return (0, import_jsx_runtime6.jsx)(Grid.Item, {
                col: 3,
                direction: "column",
                alignItems: "stretch",
                children: (0, import_jsx_runtime6.jsx)(FolderCard, {
                  ariaLabel: folder.name,
                  id: `folder-${folder.id}`,
                  onClick: () => handleClickFolderCard(folder.id, folder.path),
                  cardActions: onEditFolder && (0, import_jsx_runtime6.jsx)(IconButton, {
                    withTooltip: false,
                    label: formatMessage({
                      id: getTrad("list.folder.edit"),
                      defaultMessage: "Edit folder"
                    }),
                    onClick: () => onEditFolder(folder),
                    children: (0, import_jsx_runtime6.jsx)(ForwardRef$1z, {})
                  }),
                  children: (0, import_jsx_runtime6.jsx)(FolderCardBody, {
                    children: (0, import_jsx_runtime6.jsx)(FolderCardBodyAction, {
                      onClick: () => handleClickFolderCard(folder.id, folder.path),
                      children: (0, import_jsx_runtime6.jsxs)(Flex, {
                        tag: "h2",
                        direction: "column",
                        alignItems: "start",
                        maxWidth: "100%",
                        children: [
                          (0, import_jsx_runtime6.jsxs)(TypographyMaxWidth, {
                            fontWeight: "semiBold",
                            ellipsis: true,
                            textColor: "neutral800",
                            children: [
                              folder.name,
                              (0, import_jsx_runtime6.jsx)(VisuallyHidden, {
                                children: "-"
                              })
                            ]
                          }),
                          (0, import_jsx_runtime6.jsx)(TypographyMaxWidth, {
                            tag: "span",
                            textColor: "neutral600",
                            variant: "pi",
                            ellipsis: true,
                            children: formatMessage({
                              id: getTrad("list.folder.subtitle"),
                              defaultMessage: "{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"
                            }, {
                              folderCount: (_a2 = folder.children) == null ? void 0 : _a2.count,
                              filesCount: (_b2 = folder.files) == null ? void 0 : _b2.count
                            })
                          })
                        ]
                      })
                    })
                  })
                })
              }, `folder-${folder.id}`);
            })
          }),
          assetCount > 0 && folderCount > 0 && (0, import_jsx_runtime6.jsx)(Box, {
            paddingTop: 6,
            children: (0, import_jsx_runtime6.jsx)(Divider, {})
          }),
          assetCount > 0 && (0, import_jsx_runtime6.jsx)(Box, {
            paddingTop: 6,
            children: (0, import_jsx_runtime6.jsx)(AssetGridList, {
              allowedTypes,
              size: "S",
              assets,
              onSelectAsset,
              selectedAssets,
              onEditAsset,
              title: (!isSearchingOrFiltering || isSearchingOrFiltering && folderCount > 0) && queryObject.page === 1 && formatMessage({
                id: getTrad("list.assets.title"),
                defaultMessage: "Assets ({count})"
              }, {
                count: assetCount
              }) || ""
            })
          })
        ]
      }),
      pagination.pageCount > 0 && (0, import_jsx_runtime6.jsxs)(Flex, {
        justifyContent: "space-between",
        paddingTop: 4,
        position: "relative",
        zIndex: 1,
        children: [
          (0, import_jsx_runtime6.jsx)(PageSize, {
            pageSize: queryObject.pageSize,
            onChangePageSize
          }),
          (0, import_jsx_runtime6.jsx)(PaginationFooter, {
            activePage: queryObject.page,
            onChangePage,
            pagination
          })
        ]
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/DialogFooter.mjs
var import_jsx_runtime7 = __toESM(require_jsx_runtime(), 1);
var DialogFooter = ({ onClose, onValidate }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime7.jsxs)(Modal.Footer, {
    children: [
      (0, import_jsx_runtime7.jsx)(Button, {
        onClick: onClose,
        variant: "tertiary",
        children: formatMessage({
          id: "app.components.Button.cancel",
          defaultMessage: "Cancel"
        })
      }),
      onValidate && (0, import_jsx_runtime7.jsx)(Button, {
        onClick: onValidate,
        children: formatMessage({
          id: "global.finish",
          defaultMessage: "Finish"
        })
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/SelectedStep/SelectedStep.mjs
var import_jsx_runtime8 = __toESM(require_jsx_runtime(), 1);
var import_qs5 = __toESM(require_lib(), 1);
var SelectedStep = ({ selectedAssets, onSelectAsset, onReorderAsset }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime8.jsxs)(Flex, {
    direction: "column",
    alignItems: "stretch",
    gap: 4,
    children: [
      (0, import_jsx_runtime8.jsxs)(Flex, {
        gap: 0,
        direction: "column",
        alignItems: "start",
        children: [
          (0, import_jsx_runtime8.jsx)(Typography, {
            variant: "pi",
            fontWeight: "bold",
            textColor: "neutral800",
            children: formatMessage({
              id: getTrad("list.assets.to-upload"),
              defaultMessage: "{number, plural, =0 {No asset} one {1 asset} other {# assets}} ready to upload"
            }, {
              number: selectedAssets.length
            })
          }),
          (0, import_jsx_runtime8.jsx)(Typography, {
            variant: "pi",
            textColor: "neutral600",
            children: formatMessage({
              id: getTrad("modal.upload-list.sub-header-subtitle"),
              defaultMessage: "Manage the assets before adding them to the Media Library"
            })
          })
        ]
      }),
      (0, import_jsx_runtime8.jsx)(AssetGridList, {
        size: "S",
        assets: selectedAssets,
        onSelectAsset,
        selectedAssets,
        onReorderAsset
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/AssetDialog/AssetDialog.mjs
var LoadingBody = at(Flex)`
  /* 80px are coming from the Tabs component that is not included in the ModalBody */
  min-height: ${() => `calc(60vh + 8rem)`};
`;
var AssetContent = ({ allowedTypes = [], folderId = null, onClose, onAddAsset, onAddFolder, onChangeFolder, onValidate, multiple = false, initiallySelectedAssets = [], trackedLocation }) => {
  const [assetToEdit, setAssetToEdit] = React5.useState(void 0);
  const [folderToEdit, setFolderToEdit] = React5.useState(void 0);
  const { formatMessage } = useIntl();
  const { canRead, canCreate, isLoading: isLoadingPermissions, canUpdate, canCopyLink, canDownload } = useMediaLibraryPermissions();
  const [{ queryObject }, { onChangeFilters, onChangePage, onChangePageSize, onChangeSort, onChangeSearch, onChangeFolder: onChangeFolderParam }] = useModalQueryParams({
    folder: folderId
  });
  const { data: { pagination, results: assets } = {}, isLoading: isLoadingAssets, error: errorAssets } = useAssets({
    skipWhen: !canRead,
    query: queryObject
  });
  const { data: folders, isLoading: isLoadingFolders, error: errorFolders } = useFolders({
    enabled: canRead && !containsAssetFilter(queryObject) && (pagination == null ? void 0 : pagination.page) === 1,
    query: queryObject
  });
  const [selectedAssets, { selectOne, selectOnly, setSelections, selectMultiple, deselectMultiple }] = useSelectionState([
    "id"
  ], initiallySelectedAssets);
  const handleSelectAllAssets = () => {
    const allowedAssets = getAllowedFiles(allowedTypes, assets);
    if (!multiple) {
      return void 0;
    }
    const alreadySelected = allowedAssets.filter((asset) => selectedAssets.findIndex((selectedAsset) => selectedAsset.id === asset.id) !== -1);
    if (alreadySelected.length > 0) {
      deselectMultiple(alreadySelected);
    } else {
      selectMultiple(allowedAssets);
    }
  };
  const handleSelectAsset = (asset) => {
    return multiple ? selectOne(asset) : selectOnly(asset);
  };
  const isLoading = isLoadingPermissions || isLoadingAssets || isLoadingFolders;
  const hasError = errorAssets || errorFolders;
  const [activeTab, setActiveTab] = React5.useState(selectedAssets.length > 0 ? "selected" : "browse");
  if (isLoading) {
    return (0, import_jsx_runtime9.jsxs)(import_jsx_runtime9.Fragment, {
      children: [
        (0, import_jsx_runtime9.jsx)(Modal.Header, {
          children: (0, import_jsx_runtime9.jsx)(Modal.Title, {
            children: formatMessage({
              id: getTrad("header.actions.add-assets"),
              defaultMessage: "Add new assets"
            })
          })
        }),
        (0, import_jsx_runtime9.jsx)(LoadingBody, {
          justifyContent: "center",
          paddingTop: 4,
          paddingBottom: 4,
          children: (0, import_jsx_runtime9.jsx)(Loader, {
            children: formatMessage({
              id: getTrad("content.isLoading"),
              defaultMessage: "Content is loading."
            })
          })
        }),
        (0, import_jsx_runtime9.jsx)(DialogFooter, {
          onClose
        })
      ]
    });
  }
  if (hasError) {
    return (0, import_jsx_runtime9.jsxs)(import_jsx_runtime9.Fragment, {
      children: [
        (0, import_jsx_runtime9.jsx)(Modal.Header, {
          children: (0, import_jsx_runtime9.jsx)(Modal.Title, {
            children: formatMessage({
              id: getTrad("header.actions.add-assets"),
              defaultMessage: "Add new assets"
            })
          })
        }),
        (0, import_jsx_runtime9.jsx)(Page.Error, {}),
        (0, import_jsx_runtime9.jsx)(DialogFooter, {
          onClose
        })
      ]
    });
  }
  if (!canRead) {
    return (0, import_jsx_runtime9.jsxs)(import_jsx_runtime9.Fragment, {
      children: [
        (0, import_jsx_runtime9.jsx)(Modal.Header, {
          children: (0, import_jsx_runtime9.jsx)(Modal.Title, {
            children: formatMessage({
              id: getTrad("header.actions.add-assets"),
              defaultMessage: "Add new assets"
            })
          })
        }),
        (0, import_jsx_runtime9.jsx)(Page.NoPermissions, {}),
        (0, import_jsx_runtime9.jsx)(DialogFooter, {
          onClose
        })
      ]
    });
  }
  if (assetToEdit) {
    return (0, import_jsx_runtime9.jsx)(EditAssetContent, {
      onClose: () => setAssetToEdit(void 0),
      asset: assetToEdit,
      canUpdate,
      canCopyLink,
      canDownload,
      trackedLocation
    });
  }
  if (folderToEdit) {
    return (0, import_jsx_runtime9.jsx)(EditFolderContent, {
      folder: folderToEdit,
      onClose: () => setFolderToEdit(void 0),
      location: "content-manager",
      parentFolderId: queryObject == null ? void 0 : queryObject.folder
    });
  }
  const handleMoveItem = (hoverIndex, destIndex) => {
    const offset = destIndex - hoverIndex;
    const orderedAssetsClone = selectedAssets.slice();
    const nextAssets = moveElement(orderedAssetsClone, hoverIndex, offset);
    setSelections(nextAssets);
  };
  const handleFolderChange = (folderId2, folderPath) => {
    onChangeFolder(folderId2);
    if (onChangeFolderParam) {
      onChangeFolderParam(folderId2, folderPath);
    }
  };
  return (0, import_jsx_runtime9.jsxs)(import_jsx_runtime9.Fragment, {
    children: [
      (0, import_jsx_runtime9.jsx)(Modal.Header, {
        children: (0, import_jsx_runtime9.jsx)(Modal.Title, {
          children: formatMessage({
            id: getTrad("header.actions.add-assets"),
            defaultMessage: "Add new assets"
          })
        })
      }),
      (0, import_jsx_runtime9.jsxs)(TabsRoot, {
        variant: "simple",
        value: activeTab,
        onValueChange: setActiveTab,
        children: [
          (0, import_jsx_runtime9.jsxs)(Flex, {
            paddingLeft: 8,
            paddingRight: 8,
            paddingTop: 6,
            justifyContent: "space-between",
            children: [
              (0, import_jsx_runtime9.jsxs)(Tabs.List, {
                children: [
                  (0, import_jsx_runtime9.jsx)(Tabs.Trigger, {
                    value: "browse",
                    children: formatMessage({
                      id: getTrad("modal.nav.browse"),
                      defaultMessage: "Browse"
                    })
                  }),
                  (0, import_jsx_runtime9.jsxs)(Tabs.Trigger, {
                    value: "selected",
                    children: [
                      formatMessage({
                        id: getTrad("modal.header.select-files"),
                        defaultMessage: "Selected files"
                      }),
                      (0, import_jsx_runtime9.jsx)(Badge, {
                        marginLeft: 2,
                        children: selectedAssets.length
                      })
                    ]
                  })
                ]
              }),
              (0, import_jsx_runtime9.jsxs)(Flex, {
                gap: 2,
                children: [
                  (0, import_jsx_runtime9.jsx)(Button, {
                    variant: "secondary",
                    onClick: () => onAddFolder({
                      folderId: queryObject == null ? void 0 : queryObject.folder
                    }),
                    children: formatMessage({
                      id: getTrad("modal.upload-list.sub-header.add-folder"),
                      defaultMessage: "Add folder"
                    })
                  }),
                  (0, import_jsx_runtime9.jsx)(Button, {
                    onClick: () => onAddAsset({
                      folderId: queryObject == null ? void 0 : queryObject.folder
                    }),
                    children: formatMessage({
                      id: getTrad("modal.upload-list.sub-header.button"),
                      defaultMessage: "Add more assets"
                    })
                  })
                ]
              })
            ]
          }),
          (0, import_jsx_runtime9.jsx)(Divider, {}),
          (0, import_jsx_runtime9.jsxs)(Modal.Body, {
            children: [
              (0, import_jsx_runtime9.jsx)(Tabs.Content, {
                value: "browse",
                children: (0, import_jsx_runtime9.jsx)(BrowseStep, {
                  allowedTypes,
                  assets,
                  canCreate,
                  canRead,
                  folders,
                  onSelectAsset: handleSelectAsset,
                  selectedAssets,
                  multiple,
                  onSelectAllAsset: handleSelectAllAssets,
                  onEditAsset: setAssetToEdit,
                  onEditFolder: setFolderToEdit,
                  pagination,
                  queryObject,
                  onAddAsset,
                  onChangeFilters: (filters) => onChangeFilters(filters),
                  onChangeFolder: handleFolderChange,
                  onChangePage,
                  onChangePageSize,
                  onChangeSort: (sort) => onChangeSort(sort),
                  onChangeSearch
                })
              }),
              (0, import_jsx_runtime9.jsx)(Tabs.Content, {
                value: "selected",
                children: (0, import_jsx_runtime9.jsx)(SelectedStep, {
                  selectedAssets,
                  onSelectAsset: handleSelectAsset,
                  onReorderAsset: handleMoveItem
                })
              })
            ]
          })
        ]
      }),
      (0, import_jsx_runtime9.jsx)(DialogFooter, {
        onClose,
        onValidate: () => onValidate(selectedAssets)
      })
    ]
  });
};
var AssetDialog = ({ open = false, onClose, ...restProps }) => {
  return (0, import_jsx_runtime9.jsx)(Modal.Root, {
    open,
    onOpenChange: onClose,
    children: (0, import_jsx_runtime9.jsx)(Modal.Content, {
      children: (0, import_jsx_runtime9.jsx)(AssetContent, {
        onClose,
        ...restProps
      })
    })
  });
};
var TabsRoot = at(Tabs.Root)`
  display: flex;
  flex-direction: column;
  overflow: hidden;
`;

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryDialog/MediaLibraryDialog.mjs
var STEPS = {
  AssetSelect: "SelectAsset",
  AssetUpload: "UploadAsset",
  FolderCreate: "FolderCreate"
};
var MediaLibraryDialog = ({ onClose, onSelectAssets, allowedTypes = [
  "files",
  "images",
  "videos",
  "audios"
] }) => {
  const [step, setStep] = React6.useState(STEPS.AssetSelect);
  const [folderId, setFolderId] = React6.useState(null);
  switch (step) {
    case STEPS.AssetSelect:
      return (0, import_jsx_runtime10.jsx)(AssetDialog, {
        allowedTypes,
        folderId,
        open: true,
        onClose,
        onValidate: onSelectAssets,
        onAddAsset: () => setStep(STEPS.AssetUpload),
        onAddFolder: () => setStep(STEPS.FolderCreate),
        onChangeFolder: (folderId2) => setFolderId(folderId2),
        multiple: true
      });
    case STEPS.FolderCreate:
      return (0, import_jsx_runtime10.jsx)(EditFolderDialog, {
        open: true,
        onClose: () => setStep(STEPS.AssetSelect),
        parentFolderId: folderId
      });
    default:
      return (0, import_jsx_runtime10.jsx)(UploadAssetDialog, {
        open: true,
        onClose: () => setStep(STEPS.AssetSelect),
        folderId
      });
  }
};

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/MediaLibraryInput.mjs
var import_jsx_runtime15 = __toESM(require_jsx_runtime(), 1);
var React9 = __toESM(require_react(), 1);
var import_qs10 = __toESM(require_lib(), 1);

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/Carousel/CarouselAssets.mjs
var import_jsx_runtime14 = __toESM(require_jsx_runtime(), 1);
var React8 = __toESM(require_react(), 1);

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/Carousel/CarouselAsset.mjs
var import_jsx_runtime11 = __toESM(require_jsx_runtime(), 1);
var import_qs7 = __toESM(require_lib(), 1);
var DocAsset = at(Flex)`
  background: linear-gradient(180deg, #ffffff 0%, #f6f6f9 121.48%);
`;
var VideoPreviewWrapper = at(Box)`
  canvas,
  video {
    max-width: 100%;
    height: 124px;
  }
`;
var AudioPreviewWrapper = at(Box)`
  canvas,
  audio {
    max-width: 100%;
  }
`;
var CarouselAsset = ({ asset }) => {
  var _a, _b, _c, _d;
  if ((_a = asset.mime) == null ? void 0 : _a.includes(AssetType.Video)) {
    return (0, import_jsx_runtime11.jsx)(VideoPreviewWrapper, {
      height: "100%",
      children: (0, import_jsx_runtime11.jsx)(VideoPreview, {
        url: createAssetUrl(asset, true),
        mime: asset.mime,
        alt: asset.alternativeText || asset.name
      })
    });
  }
  if ((_b = asset.mime) == null ? void 0 : _b.includes(AssetType.Audio)) {
    return (0, import_jsx_runtime11.jsx)(AudioPreviewWrapper, {
      children: (0, import_jsx_runtime11.jsx)(AudioPreview, {
        url: createAssetUrl(asset, true),
        alt: asset.alternativeText || asset.name
      })
    });
  }
  if ((_c = asset.mime) == null ? void 0 : _c.includes(AssetType.Image)) {
    const assetUrl = createAssetUrl(asset, true);
    if (!assetUrl) return null;
    const cacheBustedUrl = asset.isUrlSigned ? assetUrl : `${assetUrl}${assetUrl.includes("?") ? "&" : "?"}updatedAt=${asset.updatedAt}`;
    return (0, import_jsx_runtime11.jsx)(Box, {
      tag: "img",
      maxHeight: "100%",
      maxWidth: "100%",
      src: cacheBustedUrl,
      alt: asset.alternativeText || asset.name
    });
  }
  return (0, import_jsx_runtime11.jsx)(DocAsset, {
    width: "100%",
    height: "100%",
    justifyContent: "center",
    hasRadius: true,
    children: ((_d = asset.ext) == null ? void 0 : _d.includes("pdf")) ? (0, import_jsx_runtime11.jsx)(ForwardRef$3x, {
      "aria-label": asset.alternativeText || asset.name,
      width: "24px",
      height: "32px"
    }) : (0, import_jsx_runtime11.jsx)(ForwardRef$3D, {
      "aria-label": asset.alternativeText || asset.name,
      width: "24px",
      height: "32px"
    })
  });
};

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/Carousel/CarouselAssetActions.mjs
var import_jsx_runtime12 = __toESM(require_jsx_runtime(), 1);
var import_qs8 = __toESM(require_lib(), 1);
var CarouselAssetActions = ({ asset, onDeleteAsset, onAddAsset, onEditAsset }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime12.jsxs)(CarouselActions, {
    children: [
      onAddAsset && (0, import_jsx_runtime12.jsx)(IconButton, {
        label: formatMessage({
          id: getTrad("control-card.add"),
          defaultMessage: "Add"
        }),
        onClick: () => onAddAsset(asset),
        children: (0, import_jsx_runtime12.jsx)(ForwardRef$1l, {})
      }),
      (0, import_jsx_runtime12.jsx)(CopyLinkButton, {
        url: prefixFileUrlWithBackendUrl(asset.url)
      }),
      onDeleteAsset && (0, import_jsx_runtime12.jsx)(IconButton, {
        label: formatMessage({
          id: "global.delete",
          defaultMessage: "Delete"
        }),
        onClick: () => onDeleteAsset(asset),
        children: (0, import_jsx_runtime12.jsx)(ForwardRef$n, {})
      }),
      onEditAsset && (0, import_jsx_runtime12.jsx)(IconButton, {
        label: formatMessage({
          id: getTrad("control-card.edit"),
          defaultMessage: "edit"
        }),
        onClick: onEditAsset,
        children: (0, import_jsx_runtime12.jsx)(ForwardRef$1z, {})
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/Carousel/EmptyStateAsset.mjs
var import_jsx_runtime13 = __toESM(require_jsx_runtime(), 1);
var React7 = __toESM(require_react(), 1);
var import_qs9 = __toESM(require_lib(), 1);
var TextAlignTypography = at(Typography)`
  align-items: center;
`;
var EmptyStateAsset = ({ disabled = false, onClick, onDropAsset }) => {
  const { formatMessage } = useIntl();
  const [dragOver, setDragOver] = React7.useState(false);
  const handleDragEnter = (e) => {
    e.preventDefault();
    setDragOver(true);
  };
  const handleDragLeave = (e) => {
    if (!e.currentTarget.contains(e.relatedTarget)) {
      setDragOver(false);
    }
  };
  const handleDragOver = (e) => {
    e.preventDefault();
  };
  const handleDrop = (e) => {
    var _a;
    e.preventDefault();
    if ((_a = e == null ? void 0 : e.dataTransfer) == null ? void 0 : _a.files) {
      const files = e.dataTransfer.files;
      const assets = [];
      for (let i = 0; i < files.length; i++) {
        const file = files.item(i);
        if (file) {
          const asset = rawFileToAsset(file, AssetSource.Computer);
          assets.push(asset);
        }
      }
      onDropAsset(assets);
    }
    setDragOver(false);
  };
  return (0, import_jsx_runtime13.jsxs)(Flex, {
    borderStyle: dragOver ? "dashed" : void 0,
    borderWidth: dragOver ? "1px" : void 0,
    borderColor: dragOver ? "primary600" : void 0,
    direction: "column",
    justifyContent: "center",
    alignItems: "center",
    height: "100%",
    width: "100%",
    tag: "button",
    type: "button",
    disabled,
    onClick,
    onDragEnter: handleDragEnter,
    onDragLeave: handleDragLeave,
    onDragOver: handleDragOver,
    onDrop: handleDrop,
    gap: 3,
    style: {
      cursor: disabled ? "not-allowed" : "pointer"
    },
    children: [
      (0, import_jsx_runtime13.jsx)(ForwardRef$1j, {
        "aria-hidden": true,
        width: "3.2rem",
        height: "3.2rem",
        fill: disabled ? "neutral400" : "primary600"
      }),
      (0, import_jsx_runtime13.jsx)(TextAlignTypography, {
        variant: "pi",
        fontWeight: "bold",
        textColor: "neutral600",
        style: {
          textAlign: "center"
        },
        tag: "span",
        children: formatMessage({
          id: getTrad("mediaLibraryInput.placeholder"),
          defaultMessage: "Click to add an asset or drag and drop one in this area"
        })
      })
    ]
  });
};

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/Carousel/CarouselAssets.mjs
var CarouselAssets = React8.forwardRef(({ assets, disabled = false, error, hint, label, labelAction, onAddAsset, onDeleteAsset, onDeleteAssetFromMediaLibrary, onDropAsset, onEditAsset, onNext, onPrevious, required = false, selectedAssetIndex, trackedLocation }, forwardedRef) => {
  const { formatMessage } = useIntl();
  const [isEditingAsset, setIsEditingAsset] = React8.useState(false);
  const currentAsset = assets[selectedAssetIndex];
  return (0, import_jsx_runtime14.jsxs)(import_jsx_runtime14.Fragment, {
    children: [
      (0, import_jsx_runtime14.jsx)(CarouselInput, {
        ref: forwardedRef,
        label,
        labelAction,
        secondaryLabel: currentAsset == null ? void 0 : currentAsset.name,
        selectedSlide: selectedAssetIndex,
        previousLabel: formatMessage({
          id: getTrad("mediaLibraryInput.actions.previousSlide"),
          defaultMessage: "Previous slide"
        }),
        nextLabel: formatMessage({
          id: getTrad("mediaLibraryInput.actions.nextSlide"),
          defaultMessage: "Next slide"
        }),
        onNext,
        onPrevious,
        hint,
        error,
        required,
        actions: currentAsset ? (0, import_jsx_runtime14.jsx)(CarouselAssetActions, {
          asset: currentAsset,
          onDeleteAsset: disabled ? void 0 : onDeleteAsset,
          onAddAsset: disabled ? void 0 : onAddAsset,
          onEditAsset: onEditAsset ? () => setIsEditingAsset(true) : void 0
        }) : void 0,
        children: assets.length === 0 ? (0, import_jsx_runtime14.jsx)(CarouselSlide, {
          label: formatMessage({
            id: getTrad("mediaLibraryInput.slideCount"),
            defaultMessage: "{n} of {m} slides"
          }, {
            n: 1,
            m: 1
          }),
          children: (0, import_jsx_runtime14.jsx)(EmptyStateAsset, {
            disabled,
            onClick: onAddAsset,
            onDropAsset
          })
        }) : assets.map((asset, index) => (0, import_jsx_runtime14.jsx)(CarouselSlide, {
          label: formatMessage({
            id: getTrad("mediaLibraryInput.slideCount"),
            defaultMessage: "{n} of {m} slides"
          }, {
            n: index + 1,
            m: assets.length
          }),
          children: (0, import_jsx_runtime14.jsx)(CarouselAsset, {
            asset
          })
        }, asset.id))
      }),
      (0, import_jsx_runtime14.jsx)(EditAssetDialog, {
        open: isEditingAsset,
        onClose: (editedAsset) => {
          setIsEditingAsset(false);
          if (editedAsset === null) {
            onDeleteAssetFromMediaLibrary();
          }
          if (editedAsset && typeof editedAsset !== "boolean") {
            onEditAsset == null ? void 0 : onEditAsset(editedAsset);
          }
        },
        asset: currentAsset,
        canUpdate: true,
        canCopyLink: true,
        canDownload: true,
        trackedLocation
      })
    ]
  });
});

// node_modules/@strapi/upload/dist/admin/components/MediaLibraryInput/MediaLibraryInput.mjs
var STEPS2 = {
  AssetSelect: "SelectAsset",
  AssetUpload: "UploadAsset",
  FolderCreate: "FolderCreate"
};
var MediaLibraryInput = React9.forwardRef(({ attribute: { allowedTypes = null, multiple = false } = {}, label, hint, disabled = false, labelAction = void 0, name: name2, required = false }, forwardedRef) => {
  const { formatMessage } = useIntl();
  const { onChange, value, error } = useField(name2);
  const [uploadedFiles, setUploadedFiles] = React9.useState([]);
  const [step, setStep] = React9.useState(void 0);
  const [selectedIndex, setSelectedIndex] = React9.useState(0);
  const [droppedAssets, setDroppedAssets] = React9.useState();
  const [folderId, setFolderId] = React9.useState(null);
  const { toggleNotification } = useNotification();
  React9.useEffect(() => {
    if (step === void 0) {
      setUploadedFiles([]);
    }
  }, [
    step
  ]);
  let selectedAssets = [];
  if (Array.isArray(value)) {
    selectedAssets = value;
  } else if (value) {
    selectedAssets = [
      value
    ];
  }
  const handleValidation = (nextSelectedAssets) => {
    const value2 = multiple ? nextSelectedAssets : nextSelectedAssets[0];
    onChange(name2, value2);
    setStep(void 0);
  };
  const handleDeleteAssetFromMediaLibrary = () => {
    let nextValue;
    if (multiple) {
      const nextSelectedAssets = selectedAssets.filter((_, assetIndex) => assetIndex !== selectedIndex);
      nextValue = nextSelectedAssets.length > 0 ? nextSelectedAssets : null;
    } else {
      nextValue = null;
    }
    const value2 = nextValue;
    onChange(name2, value2);
    setSelectedIndex(0);
  };
  const handleDeleteAsset = (asset) => {
    let nextValue;
    if (multiple) {
      const nextSelectedAssets = selectedAssets.filter((prevAsset) => prevAsset.id !== asset.id);
      nextValue = nextSelectedAssets.length > 0 ? nextSelectedAssets : null;
    } else {
      nextValue = null;
    }
    onChange(name2, nextValue);
    setSelectedIndex(0);
  };
  const handleAssetEdit = (asset) => {
    const nextSelectedAssets = selectedAssets.map((prevAsset) => prevAsset.id === asset.id ? asset : prevAsset);
    onChange(name2, multiple ? nextSelectedAssets : nextSelectedAssets[0]);
  };
  const validateAssetsTypes = (assets, callback) => {
    const allowedAssets = getAllowedFiles(allowedTypes, assets);
    if (allowedAssets.length > 0) {
      callback(allowedAssets);
    } else {
      toggleNotification({
        type: "danger",
        timeout: 4e3,
        message: formatMessage({
          id: getTrad("input.notification.not-supported"),
          defaultMessage: `You can't upload this type of file.`
        }, {
          fileTypes: (allowedTypes ?? []).join(",")
        })
      });
    }
  };
  const handleAssetDrop = (assets) => {
    validateAssetsTypes(assets, (allowedAssets) => {
      setDroppedAssets(allowedAssets);
      setStep(STEPS2.AssetUpload);
    });
  };
  if (multiple && selectedAssets.length > 0) {
    label = `${label} (${selectedIndex + 1} / ${selectedAssets.length})`;
  }
  const handleNext = () => {
    setSelectedIndex((current) => current < selectedAssets.length - 1 ? current + 1 : 0);
  };
  const handlePrevious = () => {
    setSelectedIndex((current) => current > 0 ? current - 1 : selectedAssets.length - 1);
  };
  const handleFilesUploadSucceeded = (uploadedFiles2) => {
    setUploadedFiles((prev) => [
      ...prev,
      ...uploadedFiles2
    ]);
  };
  let initiallySelectedAssets = selectedAssets;
  if (uploadedFiles.length > 0) {
    const allowedUploadedFiles = getAllowedFiles(allowedTypes, uploadedFiles);
    initiallySelectedAssets = multiple ? [
      ...allowedUploadedFiles,
      ...selectedAssets
    ] : [
      allowedUploadedFiles[0]
    ];
  }
  return (0, import_jsx_runtime15.jsxs)(import_jsx_runtime15.Fragment, {
    children: [
      (0, import_jsx_runtime15.jsx)(CarouselAssets, {
        ref: forwardedRef,
        assets: selectedAssets,
        disabled,
        label,
        labelAction,
        onDeleteAsset: handleDeleteAsset,
        onDeleteAssetFromMediaLibrary: handleDeleteAssetFromMediaLibrary,
        onAddAsset: () => setStep(STEPS2.AssetSelect),
        onDropAsset: handleAssetDrop,
        onEditAsset: handleAssetEdit,
        onNext: handleNext,
        onPrevious: handlePrevious,
        error,
        hint,
        required,
        selectedAssetIndex: selectedIndex,
        trackedLocation: "content-manager"
      }),
      step === STEPS2.AssetSelect && (0, import_jsx_runtime15.jsx)(AssetDialog, {
        allowedTypes,
        initiallySelectedAssets,
        folderId,
        onClose: () => {
          setStep(void 0);
          setFolderId(null);
        },
        open: step === STEPS2.AssetSelect,
        onValidate: handleValidation,
        multiple,
        onAddAsset: () => setStep(STEPS2.AssetUpload),
        onAddFolder: () => setStep(STEPS2.FolderCreate),
        onChangeFolder: (folder) => setFolderId(folder),
        trackedLocation: "content-manager"
      }),
      step === STEPS2.AssetUpload && (0, import_jsx_runtime15.jsx)(UploadAssetDialog, {
        open: step === STEPS2.AssetUpload,
        onClose: () => setStep(STEPS2.AssetSelect),
        initialAssetsToAdd: droppedAssets,
        addUploadedFiles: handleFilesUploadSucceeded,
        trackedLocation: "content-manager",
        folderId,
        validateAssetsTypes
      }),
      step === STEPS2.FolderCreate && (0, import_jsx_runtime15.jsx)(EditFolderDialog, {
        open: step === STEPS2.FolderCreate,
        onClose: () => setStep(STEPS2.AssetSelect),
        parentFolderId: folderId
      })
    ]
  });
});

// node_modules/@strapi/upload/dist/admin/index.mjs
var import_qs11 = __toESM(require_lib(), 1);

// node_modules/@strapi/upload/dist/admin/utils/prefixPluginTranslations.mjs
var prefixPluginTranslations = (trad, pluginId2) => {
  if (!pluginId2) {
    throw new TypeError("pluginId can't be empty");
  }
  return Object.keys(trad).reduce((acc, current) => {
    acc[`${pluginId2}.${current}`] = trad[current];
    return acc;
  }, {});
};

// node_modules/@strapi/upload/dist/admin/index.mjs
function __variableDynamicImportRuntime2__(path) {
  switch (path) {
    case "./translations/ca.json":
      return import("./ca.json-SGLYOKFN.js");
    case "./translations/de.json":
      return import("./de.json-ZBRIRFBP.js");
    case "./translations/dk.json":
      return import("./dk.json-V2MWWTY7.js");
    case "./translations/en.json":
      return import("./en.json-7E4TPUWN.js");
    case "./translations/es.json":
      return import("./es.json-W3AZZ4NL.js");
    case "./translations/fr.json":
      return import("./fr.json-5MRAYCZS.js");
    case "./translations/he.json":
      return import("./he.json-G7H73RQW.js");
    case "./translations/it.json":
      return import("./it.json-ZDRZ7F5X.js");
    case "./translations/ja.json":
      return import("./ja.json-A5FGOGTR.js");
    case "./translations/ko.json":
      return import("./ko.json-TUNMS3U3.js");
    case "./translations/ms.json":
      return import("./ms.json-4TMLK7KR.js");
    case "./translations/pl.json":
      return import("./pl.json-WI3YPLLQ.js");
    case "./translations/pt-BR.json":
      return import("./pt-BR.json-IHUN7DZM.js");
    case "./translations/pt.json":
      return import("./pt.json-3PC4SO3V.js");
    case "./translations/ru.json":
      return import("./ru.json-E3NA2AA2.js");
    case "./translations/sk.json":
      return import("./sk.json-CIND4NQ3.js");
    case "./translations/th.json":
      return import("./th.json-FIKGWXOL.js");
    case "./translations/tr.json":
      return import("./tr.json-OVRXCZHU.js");
    case "./translations/uk.json":
      return import("./uk.json-WPUUSCPA.js");
    case "./translations/zh-Hans.json":
      return import("./zh-Hans.json-WPBNXHYL.js");
    case "./translations/zh.json":
      return import("./zh.json-BZJDH453.js");
    default:
      return new Promise(function(resolve, reject) {
        (typeof queueMicrotask === "function" ? queueMicrotask : setTimeout)(
          reject.bind(null, new Error("Unknown variable dynamic import: " + path))
        );
      });
  }
}
var name = pluginPkg.strapi.name;
var admin = {
  register(app) {
    app.addMenuLink({
      to: `plugins/${pluginId}`,
      icon: ForwardRef$2N,
      intlLabel: {
        id: `${pluginId}.plugin.name`,
        defaultMessage: "Media Library"
      },
      permissions: PERMISSIONS.main,
      Component: () => import("./App-FH6BICCU.js").then((mod) => ({
        default: mod.Upload
      })),
      position: 4
    });
    app.addSettingsLink("global", {
      id: "media-library-settings",
      to: "media-library",
      intlLabel: {
        id: getTrad("plugin.name"),
        defaultMessage: "Media Library"
      },
      async Component() {
        const { ProtectedSettingsPage } = await import("./SettingsPage-EU7HXPH4.js");
        return {
          default: ProtectedSettingsPage
        };
      },
      permissions: PERMISSIONS.settings
    });
    app.addFields({
      type: "media",
      Component: MediaLibraryInput
    });
    app.addComponents([
      {
        name: "media-library",
        Component: MediaLibraryDialog
      }
    ]);
    app.registerPlugin({
      id: pluginId,
      name
    });
  },
  async registerTrads({ locales }) {
    const importedTrads = await Promise.all(locales.map((locale) => {
      return __variableDynamicImportRuntime2__(`./translations/${locale}.json`).then(({ default: data }) => {
        return {
          data: prefixPluginTranslations(data, pluginId),
          locale
        };
      }).catch(() => {
        return {
          data: {},
          locale
        };
      });
    }));
    return Promise.resolve(importedTrads);
  }
};

export {
  admin
};
//# sourceMappingURL=chunk-PBPSGT5R.js.map
