{
  "version": 3,
  "sources": ["../../../@strapi/content-type-builder/admin/src/reducers.ts", "../../../@strapi/content-type-builder/admin/src/utils/formAPI.ts", "../../../@strapi/content-type-builder/admin/src/utils/prefixPluginTranslations.ts", "../../../@strapi/content-type-builder/admin/src/index.ts"],
  "sourcesContent": ["import { reducer as dataManagerProviderReducer } from './components/DataManager/reducer';\nimport { reducer as formModalReducer } from './components/FormModal/reducer';\n\nexport const reducers = {\n  [`content-type-builder_formModal`]: formModalReducer,\n  [`content-type-builder_dataManagerProvider`]: dataManagerProviderReducer,\n};\n", "import cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport * as yup from 'yup';\n\nexport interface FormAPI {\n  components: {\n    inputs: Record<string, any>;\n    add: ({ id, component }: { id: string; component: any }) => void;\n  };\n  types: {\n    attribute: {\n      [key: string]: {\n        validators: any[];\n        form: {\n          advanced: any[];\n          base: any[];\n        };\n      };\n    };\n    contentType: {\n      validators: any[];\n      form: {\n        advanced: any[];\n        base: any[];\n      };\n    };\n    component: {\n      validators: any[];\n      form: {\n        advanced: any[];\n        base: any[];\n      };\n    };\n  };\n  contentTypeSchemaMutations: any[];\n  addContentTypeSchemaMutation: (cb: any) => void;\n  extendContentType: (data: any) => void;\n  extendFields: (fields: any[], data: any) => void;\n  getAdvancedForm: (target: any, props?: any) => any[];\n  makeCustomFieldValidator: (attributeShape: any, validator: any, ...validatorArgs: any) => any;\n  makeValidator: (target: any, initShape: any, ...args: any) => any;\n  mutateContentTypeSchema: (\n    data: Record<string, unknown>,\n    initialData: Record<string, unknown>\n  ) => any;\n}\n\nexport const formsAPI: FormAPI = {\n  components: {\n    inputs: {},\n    add({ id, component }) {\n      if (!this.inputs[id]) {\n        this.inputs[id] = component;\n      }\n    },\n  },\n  types: {\n    attribute: {\n      // test: {\n      //   validators: [],\n      //   form: {\n      //     advanced: [\n      //       /* cb */\n      //     ],\n      //     base: [\n      //       /* cb */\n      //     ],\n      //   },\n      // },\n    },\n    contentType: {\n      validators: [],\n      form: {\n        advanced: [],\n        base: [],\n      },\n    },\n    component: {\n      validators: [],\n      form: {\n        advanced: [],\n        base: [],\n      },\n    },\n  },\n  contentTypeSchemaMutations: [],\n  addContentTypeSchemaMutation(cb) {\n    this.contentTypeSchemaMutations.push(cb);\n  },\n  extendContentType({ validator, form: { advanced, base } }) {\n    const { contentType } = this.types;\n\n    if (validator) {\n      contentType.validators.push(validator);\n    }\n    contentType.form.advanced.push(advanced);\n    contentType.form.base.push(base);\n  },\n  extendFields(fields, { validator, form: { advanced, base } }) {\n    const formType = this.types.attribute;\n\n    fields.forEach((field) => {\n      if (!formType[field]) {\n        formType[field] = {\n          validators: [],\n          form: {\n            advanced: [\n              /* cb */\n            ],\n            base: [\n              /* cb */\n            ],\n          },\n        };\n      }\n\n      if (validator) {\n        formType[field].validators.push(validator);\n      }\n      formType[field].form.advanced.push(advanced);\n      formType[field].form.base.push(base);\n    });\n  },\n\n  getAdvancedForm(target, props = null) {\n    const sectionsToAdd = get(this.types, [...target, 'form', 'advanced'], []).reduce(\n      (acc: any, current: any) => {\n        const sections = current(props);\n\n        return [...acc, ...sections];\n      },\n      []\n    );\n\n    return sectionsToAdd;\n  },\n\n  makeCustomFieldValidator(attributeShape, validator, ...validatorArgs) {\n    // When no validator, return the attribute shape\n    if (!validator) return attributeShape;\n\n    // Otherwise extend the shape with the provided validator\n    return attributeShape.shape({ options: yup.object().shape(validator(validatorArgs)) });\n  },\n\n  makeValidator(target, initShape, ...args) {\n    const validators = get(this.types, [...target, 'validators'], []);\n\n    const pluginOptionsShape = validators.reduce((acc: any, current: any) => {\n      const pluginOptionShape = current(args);\n\n      return { ...acc, ...pluginOptionShape };\n    }, {});\n\n    return initShape.shape({ pluginOptions: yup.object().shape(pluginOptionsShape) });\n  },\n  mutateContentTypeSchema(data: Record<string, unknown>, initialData: Record<string, unknown>) {\n    let enhancedData = cloneDeep(data);\n\n    const refData = cloneDeep(initialData);\n\n    this.contentTypeSchemaMutations.forEach((cb: any) => {\n      enhancedData = cb(enhancedData, refData);\n    });\n\n    return enhancedData;\n  },\n};\n", "type TradOptions = Record<string, string>;\n\nconst prefixPluginTranslations = (trad: TradOptions, pluginId: string): TradOptions => {\n  if (!pluginId) {\n    throw new TypeError(\"pluginId can't be empty\");\n  }\n  return Object.keys(trad).reduce((acc, current) => {\n    acc[`${pluginId}.${current}`] = trad[current];\n    return acc;\n  }, {} as TradOptions);\n};\n\nexport { prefixPluginTranslations };\n", "import { Layout } from '@strapi/icons';\n\nimport { PERMISSIONS } from './constants';\nimport { pluginId } from './pluginId';\nimport { reducers } from './reducers';\nimport { formsAPI } from './utils/formAPI';\nimport { prefixPluginTranslations } from './utils/prefixPluginTranslations';\n\nimport type { StrapiApp } from '@strapi/admin/strapi-admin';\n\n// eslint-disable-next-line import/no-default-export\nexport default {\n  register(app: StrapiApp) {\n    app.addReducers(reducers);\n    app.addMenuLink({\n      to: `plugins/${pluginId}`,\n      icon: Layout,\n      intlLabel: {\n        id: `${pluginId}.plugin.name`,\n        defaultMessage: 'Content-Type Builder',\n      },\n      permissions: PERMISSIONS.main,\n      Component: () => import('./pages/App'),\n      position: 5,\n    });\n\n    app.registerPlugin({\n      id: pluginId,\n      name: pluginId,\n      // Internal APIs exposed by the CTB for the other plugins to use\n      apis: {\n        forms: formsAPI,\n      },\n    });\n  },\n  bootstrap() {},\n  async registerTrads({ locales }: { locales: string[] }) {\n    const importedTrads = await Promise.all(\n      locales.map((locale) => {\n        return import(`./translations/${locale}.json`)\n          .then(({ default: data }) => {\n            return {\n              data: prefixPluginTranslations(data, pluginId),\n              locale,\n            };\n          })\n          .catch(() => {\n            return {\n              data: {},\n              locale,\n            };\n          });\n      })\n    );\n\n    return Promise.resolve(importedTrads);\n  },\n};\n\nexport * from './exports';\n"],
  "mappings": "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",
  "names": ["reducers", "formModalReducer", "dataManagerProviderReducer", "formsAPI", "components", "inputs", "add", "id", "component", "types", "attribute", "contentType", "validators", "form", "advanced", "base", "contentTypeSchemaMutations", "addContentTypeSchemaMutation", "cb", "push", "extendContentType", "validator", "extendFields", "fields", "formType", "forEach", "field", "getAdvancedForm", "target", "props", "sectionsToAdd", "get", "reduce", "acc", "current", "sections", "makeCustomFieldValidator", "attributeShape", "validatorArgs", "shape", "options", "object", "makeValidator", "initShape", "args", "pluginOptionsShape", "pluginOptionShape", "pluginOptions", "mutateContentTypeSchema", "data", "initialData", "enhancedData", "cloneDeep", "refData", "prefixPluginTranslations", "trad", "pluginId", "Object", "keys", "reduce", "acc", "current", "register", "app", "addReducers", "reducers", "addMenuLink", "to", "pluginId", "icon", "Layout", "intlLabel", "id", "defaultMessage", "permissions", "PERMISSIONS", "main", "Component", "position", "registerPlugin", "name", "apis", "forms", "formsAPI", "bootstrap", "registerTrads", "locales", "importedTrads", "Promise", "all", "map", "locale", "then", "default", "data", "prefixPluginTranslations", "catch", "resolve"]
}
